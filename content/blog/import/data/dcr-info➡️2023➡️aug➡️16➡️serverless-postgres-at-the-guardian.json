{"version":3,"headline":"Aurora Serverless – a migration story","standfirst":"<p>On our team we swapped databases 6 times in a year. We’ve landed on Aurora Serverless V2 – was it worth it?</p>","webTitle":"Aurora Serverless – a migration story","mainMediaElements":[{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"1200","width":"2000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/2000.jpg"},{"index":1,"fields":{"height":"600","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/1000.jpg"},{"index":2,"fields":{"height":"300","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/500.jpg"},{"index":3,"fields":{"height":"84","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/140.jpg"},{"index":4,"fields":{"height":"3283","width":"5472"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/5472.jpg"},{"index":5,"fields":{"isMaster":"true","height":"3283","width":"5472"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg"}]},"elementId":"4f2a2d22-9c68-4fa2-9f82-ca0ee521191c","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=620&quality=85&auto=format&fit=max&s=409d2ce34cda63d8fc037d78f8af001c","width":620},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=692cefe03b47639f6f164a5ba919d90f","width":1240},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=85&auto=format&fit=max&s=ec94a05666b351a7853aef0fc2bbdd5c","width":700},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=45&auto=format&fit=max&dpr=2&s=752f9d75c3f5fa36f1be9b246a66ef2d","width":1400},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=620&quality=85&auto=format&fit=max&s=409d2ce34cda63d8fc037d78f8af001c","width":620},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=692cefe03b47639f6f164a5ba919d90f","width":1240},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=645&quality=85&auto=format&fit=max&s=afc940028d2aaa969b49090e7811352b","width":645},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=645&quality=45&auto=format&fit=max&dpr=2&s=e60f27af1c2b312c3847c275090f5893","width":1290},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=465&quality=85&auto=format&fit=max&s=b32e8a37c014b72d4af189b23ed8142a","width":465},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=465&quality=45&auto=format&fit=max&dpr=2&s=6b1ee5d1b07268c1cfbfca33e3d6e654","width":930}]},{"weighting":"thumbnail","srcSet":[]},{"weighting":"supporting","srcSet":[]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1020&quality=85&auto=format&fit=max&s=4d1a022b36a8dc6064a459d5db1261e1","width":1020},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1020&quality=45&auto=format&fit=max&dpr=2&s=46bf3d5fdb4bbcfbb904bb8580c454a7","width":2040},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=940&quality=85&auto=format&fit=max&s=91589d92fc7e0bb395be164e72ea6338","width":940},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=940&quality=45&auto=format&fit=max&dpr=2&s=7446dd059a04647cddc2996b10d31f3c","width":1880},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=85&auto=format&fit=max&s=ec94a05666b351a7853aef0fc2bbdd5c","width":700},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=45&auto=format&fit=max&dpr=2&s=752f9d75c3f5fa36f1be9b246a66ef2d","width":1400},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=85&auto=format&fit=max&s=ec94a05666b351a7853aef0fc2bbdd5c","width":700},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=45&auto=format&fit=max&dpr=2&s=752f9d75c3f5fa36f1be9b246a66ef2d","width":1400},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=660&quality=85&auto=format&fit=max&s=deebfaae8b56b897f13cf49783f810b6","width":660},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=5f69bc55f3f45a7b1cce877d38d9ca5e","width":1320},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=645&quality=85&auto=format&fit=max&s=afc940028d2aaa969b49090e7811352b","width":645},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=645&quality=45&auto=format&fit=max&dpr=2&s=e60f27af1c2b312c3847c275090f5893","width":1290},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=465&quality=85&auto=format&fit=max&s=b32e8a37c014b72d4af189b23ed8142a","width":465},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=465&quality=45&auto=format&fit=max&dpr=2&s=6b1ee5d1b07268c1cfbfca33e3d6e654","width":930}]},{"weighting":"halfwidth","srcSet":[]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1900&quality=85&auto=format&fit=max&s=41703c6c1cb8c467abbb92e4dc709206","width":1900},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=1f1a92525f9a4c1c5ebc85b624102a02","width":3800},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1300&quality=85&auto=format&fit=max&s=060466f6cb6bc72bc59aac2d9a1d658c","width":1300},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=6f5762bfe26d6433a35c75bdd47b306b","width":2600},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1140&quality=85&auto=format&fit=max&s=65e6608ae2606ac89e0c18920af26b47","width":1140},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=43c45a6b1de9325c036cf9edfeea9c8f","width":2280},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=980&quality=85&auto=format&fit=max&s=2eb82781202d6d854e9d97f07c16846a","width":980},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=9cdbb1829ff13dac24539e6abd76acd7","width":1960},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=740&quality=85&auto=format&fit=max&s=19d48f0161f03c4f5a630f06ba7e55a5","width":740},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=e9433f4e1f173a4a958fbb7ec1125fd9","width":1480},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=660&quality=85&auto=format&fit=max&s=deebfaae8b56b897f13cf49783f810b6","width":660},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=5f69bc55f3f45a7b1cce877d38d9ca5e","width":1320},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=480&quality=85&auto=format&fit=max&s=ff9e5b5d5505de6d2e7a07d93019f86f","width":480},{"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=59de3c7c2cfa5848b5c0f44532b3e56d","width":960}]}],"data":{"alt":"A mix of dark and light clouds in the sky on a day of sunshine and showers. Seasonal weather, Rotherfield Greys, Oxfordshire, UK - 10 May 2023","caption":"It’s not all sunshine up there in the cloud.","credit":"Photograph: Geoffrey Swaine/Shutterstock"}}],"main":"<figure class=\"element element-image\" data-media-id=\"1bf5f3913840dcb51cb5dd5622d3068771411efc\"> <img src=\"https://media.guim.co.uk/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/1000.jpg\" alt=\"A mix of dark and light clouds in the sky on a day of sunshine and showers. Seasonal weather, Rotherfield Greys, Oxfordshire, UK - 10 May 2023\" width=\"1000\" height=\"600\" class=\"gu-image\" /> <figcaption> <span class=\"element-image__caption\">It’s not all sunshine up there in the cloud.</span> <span class=\"element-image__credit\">Photograph: Geoffrey Swaine/Shutterstock</span> </figcaption> </figure>","filterKeyEvents":false,"keyEvents":[],"blocks":[{"id":"644bfeda8f08e1eb821c8a39","elements":[{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Since our <a href=\"https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres\">migration from Mongo to Postgres in 2018</a>, at the Guardian the search for the perfect database hasn’t stopped. In the last year on the Investigations and Reporting team we’ve spent a lot of time trying out AWS’s Serverless relational databases. We hope that by sharing our learnings we’ll help others avoid the pitfalls we hit along the way.</p>","elementId":"5086fe48-45e8-4311-b478-1ed0058e4227"},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>Application characteristics</h2>","elementId":"41fd17e9-1306-470b-a912-e463233c2b99"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The database in question is for a tool called ‘Lurch’. Lurch assembles different public data sources into a single search engine. These data sources vary in size (0.5 to 8GB) and how frequently they’re published (from daily to monthly).</p>","elementId":"40ac4666-14d6-4e7f-aee0-e01aa90ace87"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Unfortunately, unlike<a href=\"https://github.com/guardian/grid\"> many</a><a href=\"https://github.com/guardian/typerighter\"> Guardian</a><a href=\"https://github.com/guardian/giant\"> projects</a>, Lurch is currently closed source, so I’m can’t link directly to PRs in this post.</p>","elementId":"565510ad-ed70-4008-9d7f-32bef1d695e4"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The tool is only accessible to Guardian staff, with a small number of very active users, typically using it within UK working hours.</p>","elementId":"25056cc8-8ce3-4ad8-868a-09ed2a12dbe8"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The whole point of this application is to provide journalists with quick answers to queries that would otherwise have been too time consuming to answer. With that in mind, good read performance is important.The most commonly used databases at the Guardian are Elasticsearch, Postgres and DynamoDB.</p>","elementId":"5c8c29a8-6901-4de7-a82a-28540d852a83"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Probably any of these databases would have done the job. We thought Postgres was a good fit because the structure of the data we ingest is very predictable and we need to perform queries across multiple datasets (so lots of JOINs). Existing Postgres expertise on the team was also a consideration.</p>","elementId":"b58c47c5-4a73-42cc-b0e9-aaf1836a468d"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The tool links lots of different data sources together, so while we considered using a graph database, the data coming out of Lurch is often destined for a journalists’ spreadsheet, so we found it helpful to think about data in terms of tables.</p>","elementId":"884afbe3-f740-4bc0-bc6b-c56e12b793b2"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Most of the challenges discussed in this post are to do with high write volume. On the read side we’ve been making use of the full text search functionality in Postgres (edge ngrams, tsquery/tsvector) and have been very happy with it. Any slowness in search queries has always been traced back to a missing index rather than a lack of resources on the database instance.</p>","elementId":"3cdc5c26-8962-4235-b19c-c96041f0b799"},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>Application Architecture</h2>","elementId":"8e287c18-e9f7-4ade-af04-266eb4442d45"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>This is what Lurch looks like:</p>","elementId":"b068531c-4c14-4ced-a8ba-1662885f5642"},{"displayCredit":false,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"469","width":"1599"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/1599.jpg"},{"index":1,"fields":{"isMaster":"true","height":"469","width":"1599"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg"},{"index":2,"fields":{"height":"293","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/1000.jpg"},{"index":3,"fields":{"height":"147","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/500.jpg"},{"index":4,"fields":{"height":"41","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/140.jpg"}]},"elementId":"f0698892-4b9b-4623-8771-f89db18e3ed6","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=85&auto=format&fit=max&s=e05d68030d6abdd6564a6880f118b7bb","width":620},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=f807cf2064bcad5836bcb527e7687a0e","width":1240},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=85&auto=format&fit=max&s=8355b4b2c30e42880fdc26c154009d1d","width":605},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=3b31fce287fb73559ef547f408e629d1","width":1210},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=85&auto=format&fit=max&s=13ba09c85f735cce9a490b52aa3f2c52","width":445},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=2725bafe2d7987d31138cd060ded6165","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=140&quality=85&auto=format&fit=max&s=fc0dd752b65b34f2cb27b0e081970f67","width":140},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=140&quality=45&auto=format&fit=max&dpr=2&s=a54b580e6da480d71f7435a86e456c11","width":280},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=120&quality=85&auto=format&fit=max&s=7528f1950a425dd080f2148b7f6880ae","width":120},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=120&quality=45&auto=format&fit=max&dpr=2&s=cc8708b3dcb7e1f89531bf8f6b3c72ff","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=380&quality=85&auto=format&fit=max&s=653cbd1a477b1c0d0cf98841befbe4b8","width":380},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=380&quality=45&auto=format&fit=max&dpr=2&s=1b37a27a5bf033da0ce30cc5eaf4de8a","width":760},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=300&quality=85&auto=format&fit=max&s=bf8c46eaf68948d7b59814e860c3d6ab","width":300},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=300&quality=45&auto=format&fit=max&dpr=2&s=db78da42523f04a1fd2d1f8dddc23639","width":600},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=85&auto=format&fit=max&s=e05d68030d6abdd6564a6880f118b7bb","width":620},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=f807cf2064bcad5836bcb527e7687a0e","width":1240},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=85&auto=format&fit=max&s=8355b4b2c30e42880fdc26c154009d1d","width":605},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=3b31fce287fb73559ef547f408e629d1","width":1210},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=85&auto=format&fit=max&s=13ba09c85f735cce9a490b52aa3f2c52","width":445},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=2725bafe2d7987d31138cd060ded6165","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=860&quality=85&auto=format&fit=max&s=220f041fcbf278dee34bec91506dd8c5","width":860},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=860&quality=45&auto=format&fit=max&dpr=2&s=410361ff39ec1a617a62c5f1bc792af5","width":1720},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=780&quality=85&auto=format&fit=max&s=b88cfbc577654731671069f392098470","width":780},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=780&quality=45&auto=format&fit=max&dpr=2&s=f17597ca1cf18fe446d4156e2cf27cf1","width":1560},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=85&auto=format&fit=max&s=e05d68030d6abdd6564a6880f118b7bb","width":620},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=f807cf2064bcad5836bcb527e7687a0e","width":1240},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=85&auto=format&fit=max&s=8355b4b2c30e42880fdc26c154009d1d","width":605},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=3b31fce287fb73559ef547f408e629d1","width":1210},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=85&auto=format&fit=max&s=13ba09c85f735cce9a490b52aa3f2c52","width":445},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=2725bafe2d7987d31138cd060ded6165","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=85&auto=format&fit=max&s=e05d68030d6abdd6564a6880f118b7bb","width":620},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=f807cf2064bcad5836bcb527e7687a0e","width":1240},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=85&auto=format&fit=max&s=8355b4b2c30e42880fdc26c154009d1d","width":605},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=3b31fce287fb73559ef547f408e629d1","width":1210},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=85&auto=format&fit=max&s=13ba09c85f735cce9a490b52aa3f2c52","width":445},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=2725bafe2d7987d31138cd060ded6165","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1900&quality=85&auto=format&fit=max&s=fcc09e1711fbe23f2548a26fe8e4fcd0","width":1900},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=8e643ab8fff9d4c9ff22fae46cf68305","width":3800},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1300&quality=85&auto=format&fit=max&s=eb197e59e0591b915c1c5cdf7a557316","width":1300},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=daac7d022103e9951f145f11954f8c71","width":2600},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1140&quality=85&auto=format&fit=max&s=46adcc73d4a52811709f0ec0339b2b89","width":1140},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=c9b45c94bafbb617c194bb5719c71742","width":2280},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=980&quality=85&auto=format&fit=max&s=28755b26aca7d609b02e984e16faf4d7","width":980},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=9969d340f4dfd4b4bec1523fccb09c22","width":1960},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=740&quality=85&auto=format&fit=max&s=2c0f7204510325b4a2450317291d0c31","width":740},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=15ef0f0d0e938197362e41781f152a21","width":1480},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=660&quality=85&auto=format&fit=max&s=dce2d2b4576b97c45bd81f075fd50b01","width":660},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=f51fc7f3318f2af27854ad2a718d2859","width":1320},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=480&quality=85&auto=format&fit=max&s=16c379bb502e86a1954324dbefa36ebb","width":480},{"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=8f064006ead1d774a8abd87a84e01f52","width":960}]}],"data":{"alt":"Architecture diagram of Lurch showing ingest microservices, Postgres database and lurch web application","caption":"Architecture diagram of Lurch application","credit":"Illustration: Philip McMahon"}},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>Database 1 – RDS Postgres</h2>","elementId":"3923b6ac-3a57-45dd-bee2-cec68c582835"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>At $57/month, a db.t3.medium RDS Postgres instance seemed like a good starting point. So we set up an initial app with our first dataset (1.5 million rows).</p>","elementId":"6f69323d-94da-4e99-a315-2005e048d157"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The problems began when we started trying to ingest the full archive of historical public data – over 100 million rows, and over 100GB of data.</p>","elementId":"2b878350-d0da-482b-b219-2819054c65d6"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The T series of RDS instances are called ‘burstable’ instances. The main characteristic of these instances is that you don’t rent the entire CPU, just a fraction of it. The instance size we were using – db.t3.medium includes 20% of the CPU. Any time the instance uses less than 20% it ‘earns’ CPU credits, which are then spent whenever the CPU usage goes above 20%. This works well for applications which have inconsistent usage – for example with ‘spikes’ of usage at certain times of day.</p>","elementId":"a70504f0-4db3-433a-aeb5-0de570b99c60"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>A burstable instance seemed like a perfect fit for Lurch – particularly given that at this point we didn’t have any actual users. Our assumption was that whenever we weren’t ingesting data we’d be earning CPU credits, which we could then spend to complete the ingest jobs.</p>","elementId":"fcd03615-5741-4582-905f-7a815ba76b69"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>There’s a limit on the number of credits a burstable instance can earn – equal to the number of credits earned over a 24-hour period. A t3.medium database instance with its ‘maximum’ number of burst credits banked is able to use 100% of the CPU for four hours and 48 minutes.</p>","elementId":"e872f9a2-089b-48ad-b5dd-61d62f06013f"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Unfortunately, our ingest job was large enough that we burned through all of our burst credits. We decided that, at least while we were getting this large amount of historical data into Lurch, we should move to a different instance type. When downtime isn’t a concern, vertical scaling in RDS is easy. We moved to a db.m6g.large, increasing our monthly costs from $57 to $128. The M series of AWS instances provides 100% of the CPU so we no longer had to worry about burst credits.</p>","elementId":"36bc0067-d37f-4e55-824e-8156a1f2af97"},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>IOPS Constraints</h2>","elementId":"ed694750-b250-4176-b284-a8bd85fc3c37"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>With two whole CPUs at our disposal, we kicked off our ingestion task again, only to run into another resource problem – this time related to read/write disk operations.</p>","elementId":"09732072-087a-4f93-b3d7-5c637ca42fbd"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Amazon RDS has various payment models for a database reading/writing to disk. These derive from the instance storage type. The default in 2021 was gp2, where a DB would receive 3 IOPS for every GB of storage, with a minimum of 100 IOPS.</p>","elementId":"6ebfbf70-2caa-4c56-8987-6b80aece0f9e"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>There’s a much better explanation of how gp2 storage works<a href=\"https://aws.amazon.com/blogs/database/understanding-burst-vs-baseline-performance-with-amazon-rds-and-gp2/\"> here</a><strong>, </strong>but I’ll do my best to summarise. Our database started with just 20GB of allocated storage(there’s a lot of duplication in the original public data). This equates to 20 x 3 = 60 IOPS, so we had the minimum 100 IOPS.</p>","elementId":"622c03a1-250b-4afb-9040-9398de608823"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>With 100 IOPS we can read/write 100 times a second, right? Wrong! gp2 storage is also ‘burstable’ – every IOP that isn’t used gets ‘banked’ as I/O credits up to a maximum of 5.4 million – or enough to perform 3,000 IOPS for 30 minutes.</p>","elementId":"0d0a73f9-93d6-4283-b9de-bf417d316814"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>In theory, this model was perfect for Lurch. We could use the burst capacity during our ingest jobs and store up credits the rest of the time. However, as with the CPU issues discussed above, our initial ingest job took a lot longer than 30 minutes. It would slow to a crawl once we’d burned through our I/O credits and had to make do with the baseline of 100 IOPS.</p>","elementId":"06c0e6c3-cbb4-4d6c-a2bf-16a16e0a83ef"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>There were two options available to us: allocate more storage or switch to ‘provisioned IOPS storage’. We did both – first bumping to 100GB of storage, then when that wasn’t enough, moving to provisioned IOPS.</p>","elementId":"6528a571-f1ce-4a25-8aba-f0222db24ac0"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Provisioned IOPS storage (io1) is not cheap –<a href=\"https://aws.amazon.com/rds/postgresql/pricing/?pg=pr&amp;loc=3\"> $0.11/IOPS/month</a> – so for 1,000 IOPS (the minimum you can provision) we were looking at an extra $110/month – almost as much as the cost of the instance itself. We only needed to run this big ingest job once though. Once that was complete, we switched back to using the cheaper gp2 storage.</p>","elementId":"819e48cb-af3a-4a3a-9202-1a50b95c9f17"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p><em>Note – there is a new storage type – gp3 – now available in RDS. See<a href=\"https://aws.amazon.com/about-aws/whats-new/2022/11/amazon-rds-general-purpose-gp3-storage-volumes/\"> here</a> for the details. The headline is it’s 20% cheaper and provides a much higher baseline number of IOPS.</em></p>","elementId":"ed1991d3-1d95-4eb9-89a2-38438167b13a"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>All was well … until we started adding more datasets to Lurch – some of them updated daily rather than monthly. We found we were burning through our IOPs regularly during an ingest, resulting in the job failing or taking too long to complete.</p>","elementId":"2f077f4e-3b2c-4c5e-a64b-74ad83a28c04"},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>Heading north</h2>","elementId":"89d7fdd7-926e-4874-89e0-20e5fcbda43a"},{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"2100","width":"3499"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/3499.jpg"},{"index":1,"fields":{"isMaster":"true","height":"2100","width":"3499"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg"},{"index":2,"fields":{"height":"1200","width":"2000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/2000.jpg"},{"index":3,"fields":{"height":"600","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/1000.jpg"},{"index":4,"fields":{"height":"300","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/500.jpg"},{"index":5,"fields":{"height":"84","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/140.jpg"}]},"elementId":"bf73cbcd-1581-4743-9cc6-781166bb175b","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=85&auto=format&fit=max&s=5b2556adb19e95b296f95949b3f1bf3b","width":620},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=b80a1d4dc88e3c2f86b01f8e40558bf6","width":1240},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=85&auto=format&fit=max&s=a7b606efda9728afec843956d4169d5c","width":605},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=8dab0b36069e84f283b4a9905aa9f51e","width":1210},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=85&auto=format&fit=max&s=c00e483c2d38fbd3198a9f21278af0f9","width":445},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=0b2a0e845e9e9566a4fa736e28124bdb","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=140&quality=85&auto=format&fit=max&s=a892b5a3fafaa49a05ca9036b0e32631","width":140},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=140&quality=45&auto=format&fit=max&dpr=2&s=a1f87a287e9d3877dd1c7a811e33f15e","width":280},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=120&quality=85&auto=format&fit=max&s=8fc844f81e73f29217545d1fc235152e","width":120},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=120&quality=45&auto=format&fit=max&dpr=2&s=458dc8f9f69028840deb4277f86e36dd","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=380&quality=85&auto=format&fit=max&s=440af838fe42067725bfec76151fd73e","width":380},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=380&quality=45&auto=format&fit=max&dpr=2&s=56a5df9dc108ae18283383cabe42ca85","width":760},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=300&quality=85&auto=format&fit=max&s=deac7c1c149904b3719c190b415238f1","width":300},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=300&quality=45&auto=format&fit=max&dpr=2&s=18fa81f83ebfc2f1ef7f5aa1494f759b","width":600},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=85&auto=format&fit=max&s=5b2556adb19e95b296f95949b3f1bf3b","width":620},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=b80a1d4dc88e3c2f86b01f8e40558bf6","width":1240},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=85&auto=format&fit=max&s=a7b606efda9728afec843956d4169d5c","width":605},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=8dab0b36069e84f283b4a9905aa9f51e","width":1210},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=85&auto=format&fit=max&s=c00e483c2d38fbd3198a9f21278af0f9","width":445},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=0b2a0e845e9e9566a4fa736e28124bdb","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=860&quality=85&auto=format&fit=max&s=d0dcc216ccbfb66e2d8b6c0aaa0e6d6d","width":860},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=860&quality=45&auto=format&fit=max&dpr=2&s=7d362068b4c392860a59a67c18d8c66e","width":1720},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=780&quality=85&auto=format&fit=max&s=7f104724cf1ca6ebe8d58cd3dbd54d0a","width":780},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=780&quality=45&auto=format&fit=max&dpr=2&s=94dcb22424b1faa8955e19c6f5694e4a","width":1560},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=85&auto=format&fit=max&s=5b2556adb19e95b296f95949b3f1bf3b","width":620},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=b80a1d4dc88e3c2f86b01f8e40558bf6","width":1240},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=85&auto=format&fit=max&s=a7b606efda9728afec843956d4169d5c","width":605},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=8dab0b36069e84f283b4a9905aa9f51e","width":1210},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=85&auto=format&fit=max&s=c00e483c2d38fbd3198a9f21278af0f9","width":445},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=0b2a0e845e9e9566a4fa736e28124bdb","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=85&auto=format&fit=max&s=5b2556adb19e95b296f95949b3f1bf3b","width":620},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=b80a1d4dc88e3c2f86b01f8e40558bf6","width":1240},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=85&auto=format&fit=max&s=a7b606efda9728afec843956d4169d5c","width":605},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=8dab0b36069e84f283b4a9905aa9f51e","width":1210},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=85&auto=format&fit=max&s=c00e483c2d38fbd3198a9f21278af0f9","width":445},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=0b2a0e845e9e9566a4fa736e28124bdb","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1900&quality=85&auto=format&fit=max&s=d966956cfcad51dca7ead4dc5475898a","width":1900},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=53ea395cc9e69abe91d07e111323b8c8","width":3800},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1300&quality=85&auto=format&fit=max&s=75b043f32aa1f1388f89fa13c8e9522e","width":1300},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=501f5143d9f9162a972c43073e744d39","width":2600},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1140&quality=85&auto=format&fit=max&s=e5a6b82756f569173062b6ff7feed2c3","width":1140},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=42e442c1606c8f42a0a3d6d23219bd08","width":2280},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=980&quality=85&auto=format&fit=max&s=56ec20a8460ce5ed73f9eb728064b7ab","width":980},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=64efdae4e476381760599b52712d1932","width":1960},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=740&quality=85&auto=format&fit=max&s=7e01564093788d84cad254f9eed07b56","width":740},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=c552c56708c38b3af6082f8fc26b0b8a","width":1480},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=660&quality=85&auto=format&fit=max&s=9a0838da55fd24fd03d22a87c79a45d0","width":660},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=870f42149bcb8d9b45dee1f24773e378","width":1320},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=480&quality=85&auto=format&fit=max&s=716708e99899c39903e691f47370061b","width":480},{"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=558e7f0abaeac96a7267f2f7a682b01e","width":960}]}],"data":{"alt":"Aurora borealis Visible From North Coast Of Scotland","caption":"The aurora borealis – not to be confused with a pile of VMs somewhere in eu-west-1.","credit":"Photograph: Peter Summers/Getty Images"}},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>At this point, we started looking at Aurora. Aurora is a Postgres-compatible database engine re-engineered by AWS. Aurora uses distributed storage with a different payment model. Rather than provisioning or having burstable IOPs, you simply<a href=\"https://aws.amazon.com/rds/aurora/pricing/?pg=pr&amp;loc=1\"> pay per GB of data stored and per DB read/write operation</a>.</p>","elementId":"919cbc93-9a60-4f5d-9aa6-836ba00d9e57"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>We’d initially disregarded Aurora because at the time we were using the<a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_PostgreSQL.S3Import.html\"> Postgres S3 extension</a> to import data directly from S3 into our database. We really wanted that new storage model though, so we decided to experiment with Aurora.</p>","elementId":"7e075cff-4561-4701-966a-6bfde0caa4c1"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Migrating from Postgres RDS to Aurora Postgres RDS wasn’t as easy as we hoped. None of Amazon’s snapshot/restore tools worked so we used pg_dump and pg_restore to copy our data across. Running on an Aurora Postgres db.t4g.large instance ($112/month), our ingest jobs started running reliably again.</p>","elementId":"640a007a-e4e7-49d0-bca7-8edaa59e05cb"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>This was quite a win – for roughly the same price we now had a database that served our needs. We could have stopped there and got on with delivering value for our users, but unfortunately after all the migration work we’d forgotten how to write application code. So, time for another migration.</p>","elementId":"4f3f07ef-bfe5-447e-ad4b-3cabb4d8b3fb"},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>Make it more serverless!</h2>","elementId":"e4c805a6-7984-4ae5-bd81-350943f964f5"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>What we hoped would be the final step of this database journey was a migration to Aurora Serverless V1. Where Aurora makes storage and disk I/O fully scalable, Aurora Serverless makes compute and memory scalable as well. The model sounded perfect for a product such as Lurch – allowing us to have a powerful DB during ingestion, then scale right down the rest of the time. Aurora Serverless V1 has an ‘auto pause’ feature where it will switch off completely if no database queries are made for a set period of time – which we assumed would mean paying $0 for our database instance when the UK was asleep. Quite the saving.</p>","elementId":"9d0f568d-94e7-496a-a044-d3a243b115ea"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The migration to Aurora Serverless V1 wasn’t fun. We ran into a whole host of issues. Our DB was using Postgres 13 while the max version of Aurora Serverless V1 was 10, so we had to rewrite some of our table definitions and queries to work with Postgres 10.</p>","elementId":"12c93217-4520-44b5-a0e7-6abc2efaa941"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Furthermore, our dream of having a ‘free’ database when we weren’t using it didn’t come true, as the ‘scale up’ time of Aurora Serverless was more than 10 seconds – far too long for a journalist to wait to use our service. So we had to provision 2 ACUs (the minimum) permanently in production, and put up with the slow startup on our dev environment.</p>","elementId":"75e5ba72-72e2-483a-b6df-d365eaaaf50d"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Finally, we ran into an undocumented constraint of Aurora Serverless V1 that took a lot of debugging time to resolve. I’m eternally grateful to the author of<a href=\"https://www.jeremydaly.com/aurora-serverless-the-good-the-bad-and-the-scalable/#div-comment-18810\"> this comment</a>, for explaining that Aurora Serverless V1 doesn’t actually have a completely scalable disk. Somewhere there’s a server with a set amount of disk space that is proportional to the number of ACUs you allocate to the database. As the DB can’t scale during a transaction, we ended up adding code to scale up the DB before running any ingestions.</p>","elementId":"5b60e3b2-7d12-48a1-8276-a228cfa923df"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Despite all these issues, we did run Aurora Serverless V1 for just under a year, while we waited for AWS to release cloudformation for their even <em>more</em> serverless database – Aurora Serverless V2!</p>","elementId":"7b09d856-2312-48b2-9e23-e8a9a450bc5b"},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>Aurora Serverless V2 – happily ever after?</h2>","elementId":"beec5ce6-334b-4b94-81e8-86410f3edc77"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Aurora Serverless V2 dealt with all of the issues above. It supports recent Postgres versions and (for our purposes) scales <em>almost</em> seamlessly without having to be warned in advance that something is about to happen.</p>","elementId":"4188c463-04ea-4c94-a25c-3cb66d5a7585"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>AWS dropped the ‘auto pause’ functionality for V2 so we do have to pay for 0.5 ACUs constantly on our production and dev clusters. This has the upside of delivering much better cold start performance. The only issue we have now is that if we perform a very expensive query from a cold start (0.5 ACUs), it will often take longer than 30s (the max timeout of API Gateway which we’re using for our backend). Repeating the same query a few seconds later once the DB has a chance to scale results in a much faster response.</p>","elementId":"f5699a37-4246-43b1-bf60-801510fbd688"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The migration once again involved pg_dump and pg_restore – commands which we ran from our bastion host to speed things along. What made setting up Aurora V2 more challenging was the<a href=\"https://github.com/aws/aws-cdk/issues/20197\"> lack of support</a> for it in CDK Level 2 constructs – only <a href=\"https://github.com/aws/aws-cdk/pull/25437\">added in May 2023</a>. We worked around it by using the Level 1 CfnDBCluster construct but will now need to rewrite it using the nice new Level 2 constructs.</p>","elementId":"598ffd1d-4176-485e-ad78-51fb76c27e24"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>We’re spending roughly $220/month for storage and compute for the database. For the same price we could have rented a db.m7g.xlarge (16GB RAM, 4 vCPUs) Postgres instance along with 100GB of EBS storage or a db.r7g.large (16GB RAM, 2 vCPUs) Aurora instance. I suspect both of these options would have done the job for us, and maybe not have suffered from the same cold start problems as our serverless database, but after 3 migrations, it’s probably time to get back to doing some feature work!</p>","elementId":"2c50adad-e62d-472c-8c2d-064df70b7ce2"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Below is a table outlining how our monthly baseline database costs have changed – unfortunately I’ve had to include it as an image, for a responsive version see <a href=\"https://gist.github.com/philmcmahon/25bc821e34dd34a2335079e2a75145d4\">here</a>.</p>","elementId":"16941468-9f0b-4606-9137-9359c6b05274"},{"displayCredit":false,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"520","width":"1942"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/1942.jpg"},{"index":1,"fields":{"isMaster":"true","height":"520","width":"1942"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg"},{"index":2,"fields":{"height":"268","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/1000.jpg"},{"index":3,"fields":{"height":"134","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/500.jpg"},{"index":4,"fields":{"height":"37","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/140.jpg"}]},"elementId":"04b3bda2-3043-47ce-bea1-a9ba3021c911","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=85&auto=format&fit=max&s=552b68162cf13a89c2b925872055a19c","width":620},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=a8d990ca76931951919ec70e8fa1a213","width":1240},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=85&auto=format&fit=max&s=cbf67078ad59fa1d96c3e4889c401689","width":605},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=d912425be4d45ecfa06057144bb41a14","width":1210},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=85&auto=format&fit=max&s=803ac04f0479f4b6a2d6eb85c7c01880","width":445},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=8b45d927e1d26fe86182dc3198842f72","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=140&quality=85&auto=format&fit=max&s=32a40323201b8bb9a9fa52002ad37215","width":140},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=140&quality=45&auto=format&fit=max&dpr=2&s=65d0ed85ea71d81d7b33891e0fed2d91","width":280},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=120&quality=85&auto=format&fit=max&s=62b7f38af8f6942f5176e2ab216bcba9","width":120},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=120&quality=45&auto=format&fit=max&dpr=2&s=a9427cb11e67152e640bb28989642dce","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=380&quality=85&auto=format&fit=max&s=8125aeec4872e9d5f135140a91fa6dec","width":380},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=380&quality=45&auto=format&fit=max&dpr=2&s=b90fc85ebc9bbd1682782fda8d2920db","width":760},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=300&quality=85&auto=format&fit=max&s=931ae06aab282cdda20a8dd434e7ab01","width":300},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=300&quality=45&auto=format&fit=max&dpr=2&s=12777a4e21dcbf0db03a03aef6c71ce2","width":600},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=85&auto=format&fit=max&s=552b68162cf13a89c2b925872055a19c","width":620},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=a8d990ca76931951919ec70e8fa1a213","width":1240},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=85&auto=format&fit=max&s=cbf67078ad59fa1d96c3e4889c401689","width":605},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=d912425be4d45ecfa06057144bb41a14","width":1210},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=85&auto=format&fit=max&s=803ac04f0479f4b6a2d6eb85c7c01880","width":445},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=8b45d927e1d26fe86182dc3198842f72","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=860&quality=85&auto=format&fit=max&s=71c53e13753fbfaf3d66786ca82869b3","width":860},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=860&quality=45&auto=format&fit=max&dpr=2&s=5fd5dde45932cadde0f40a561333f388","width":1720},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=780&quality=85&auto=format&fit=max&s=07bda3002fad0d2d80e101ca59eee726","width":780},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=780&quality=45&auto=format&fit=max&dpr=2&s=46a4846506de5efff5886488a8590407","width":1560},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=85&auto=format&fit=max&s=552b68162cf13a89c2b925872055a19c","width":620},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=a8d990ca76931951919ec70e8fa1a213","width":1240},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=85&auto=format&fit=max&s=cbf67078ad59fa1d96c3e4889c401689","width":605},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=d912425be4d45ecfa06057144bb41a14","width":1210},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=85&auto=format&fit=max&s=803ac04f0479f4b6a2d6eb85c7c01880","width":445},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=8b45d927e1d26fe86182dc3198842f72","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=85&auto=format&fit=max&s=552b68162cf13a89c2b925872055a19c","width":620},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=a8d990ca76931951919ec70e8fa1a213","width":1240},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=85&auto=format&fit=max&s=cbf67078ad59fa1d96c3e4889c401689","width":605},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=d912425be4d45ecfa06057144bb41a14","width":1210},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=85&auto=format&fit=max&s=803ac04f0479f4b6a2d6eb85c7c01880","width":445},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=8b45d927e1d26fe86182dc3198842f72","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1900&quality=85&auto=format&fit=max&s=c404552aa6c42aee71f9917cf46674f9","width":1900},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=f0faec1377583f43451402b9f180c1e8","width":3800},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1300&quality=85&auto=format&fit=max&s=20dd9f62ef67bb5d110cd9dbd1b01910","width":1300},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=e37349a1f9a5485c584eaf4ec5e66bf9","width":2600},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1140&quality=85&auto=format&fit=max&s=44f63cdd8f8837c29fdfbcb76b2f8e41","width":1140},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=bf15ecc71162d54514444391775a62ba","width":2280},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=980&quality=85&auto=format&fit=max&s=5876c8e3a9383b826355d5fb9334d41c","width":980},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=1f8b3438efa57fb0964507250bc60d13","width":1960},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=740&quality=85&auto=format&fit=max&s=2a930927733d4bdebfbde6e4322f5b23","width":740},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=c8d74647eb906666085679dc2408399f","width":1480},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=660&quality=85&auto=format&fit=max&s=893af86eaf8c9f61728679eb5a6e297f","width":660},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=6bb64bd1768da2fbca0bd8652d1a8a49","width":1320},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=480&quality=85&auto=format&fit=max&s=c2f984c9c225fbf81907385675614219","width":480},{"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=7f5429b7f0dfa398c472ed4f8d4fa34e","width":960}]}],"data":{"alt":"Costs table for different stages of aurora serverless migration","caption":"Costs table for the different stages of aurora serverless migration","credit":"Illustration: Philip McMahon/The Guardian"}},{"_type":"model.dotcomrendering.pageElements.SubheadingBlockElement","html":"<h2>The end</h2>","elementId":"7dc7d916-0c70-4497-8d7a-a8c0c3e0bbe3"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Aurora Serverless V2 solved almost all of our performance problems and we’re happy enough with it to keep using the platform for the foreseeable future. It’s great being able to assume that, if we suffer a performance problem, it’s probably our dodgy SQL rather than under-provisioned hardware.</p>","elementId":"2b57fc97-c4d8-405d-b9ae-0c90fb4f83c5"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>It’s not clear whether we’ve saved any money, despite our application characteristics being near perfect for a serverless database. Our recommendation would be to use aurora serverless only when you actually <em>need</em> to scale quickly - not purely as a cost cutting exercise.</p>","elementId":"2919c65c-2969-4c8f-8b6b-4c7c6b4b2a61"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The other key lesson in this process was not to adopt an AWS service that already has a ‘V2’ in active development - a clear sign something went wrong with V1!</p>","elementId":"9714e9b3-0a0b-43ad-9e1f-d87c31a2f949"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p><em>You can read more about the work of the Digital Investigations and Reporting team in a <a href=\"https://www.theguardian.com/info/2021/jan/12/how-technology-is-powering-environmental-reporting\">previous series of blog posts</a></em></p>","elementId":"88c63d5e-3a7f-440e-bb07-43d3d5d9436d"}],"attributes":{"pinned":false,"keyEvent":false,"summary":false},"blockCreatedOn":1692175564000,"blockCreatedOnDisplay":"09.46 BST","blockLastUpdated":1692023543000,"blockLastUpdatedDisplay":"15.32 BST","contributors":[],"primaryDateLine":"Wed 16 Aug 2023 09.46 BST","secondaryDateLine":"Last modified on Wed 16 Aug 2023 17.03 BST"}],"author":{"byline":"Philip McMahon"},"byline":"Philip McMahon","webPublicationDate":"2023-08-16T08:46:04.000Z","webPublicationDateDeprecated":"2023-08-16T08:46:04.000Z","webPublicationDateDisplay":"Wed 16 Aug 2023 09.46 BST","webPublicationSecondaryDateDisplay":"Last modified on Wed 16 Aug 2023 17.03 BST","editionLongForm":"UK edition","editionId":"UK","pageId":"info/2023/aug/16/serverless-postgres-at-the-guardian","canonicalUrl":"https://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian","format":{"design":"ArticleDesign","theme":"NewsPillar","display":"StandardDisplay"},"designType":"Article","tags":[{"id":"info/series/engineering-blog","type":"Series","title":"Engineering blog"},{"id":"type/article","type":"Type","title":"Article"},{"id":"profile/philip-mcmahon","type":"Contributor","title":"Philip McMahon","bylineImageUrl":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2015/1/29/1422531426034/phil.jpg?width=300&quality=85&auto=format&fit=max&s=dc3d05bb70148999e58e102b8306d551"}],"pillar":"news","isLegacyInteractive":false,"isImmersive":false,"sectionLabel":"","sectionUrl":"","sectionName":"info","subMetaSectionLinks":[{"url":"/info/series/engineering-blog","title":"Engineering blog"}],"subMetaKeywordLinks":[],"shouldHideAds":false,"isAdFreeUser":false,"webURL":"https://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian","linkedData":[{"@type":"NewsArticle","@context":"https://schema.org","@id":"https://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian","publisher":{"@type":"Organization","@context":"https://schema.org","@id":"https://www.theguardian.com#publisher","name":"The Guardian","url":"https://www.theguardian.com/","logo":{"@type":"ImageObject","url":"https://uploads.guim.co.uk/2018/01/31/TheGuardian_AMP.png","width":190,"height":60},"sameAs":["https://www.facebook.com/theguardian","https://twitter.com/guardian","https://www.youtube.com/user/TheGuardian"]},"isAccessibleForFree":true,"isPartOf":{"@type":["CreativeWork","Product"],"name":"The Guardian","productID":"theguardian.com:basic"},"image":["https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1200&height=630&quality=85&auto=format&fit=crop&overlay-align=bottom%2Cleft&overlay-width=100p&overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctYWdlLTIwMjMucG5n&enable=upscale&s=527f45fce3fe72620ed449b5d103fee0","https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1200&height=1200&quality=85&auto=format&fit=crop&s=5da2c9b917fbb45811a35de47537a851","https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1200&height=900&quality=85&auto=format&fit=crop&s=772138386b8858e7919ab52a626d89eb","https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1200&quality=85&auto=format&fit=max&s=64a808436071ca677497946dc3b9d816"],"author":[{"@type":"Person","name":"Philip McMahon","sameAs":"https://www.theguardian.com/profile/philip-mcmahon"}],"datePublished":"2023-08-16T08:46:04.000Z","headline":"Aurora Serverless – a migration story","dateModified":"2023-08-16T16:03:03.000Z","mainEntityOfPage":"https://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian"},{"@type":"WebPage","@context":"https://schema.org","@id":"https://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian","potentialAction":{"@type":"ViewAction","target":"android-app://com.guardian/https/www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian"}}],"openGraphData":{"og:url":"https://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian","article:author":"https://www.theguardian.com/profile/philip-mcmahon","og:image:width":"1200","og:image":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1200&height=630&quality=85&auto=format&fit=crop&overlay-align=bottom%2Cleft&overlay-width=100p&overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctYWdlLTIwMjMucG5n&enable=upscale&s=527f45fce3fe72620ed449b5d103fee0","al:ios:url":"gnmguardian://info/2023/aug/16/serverless-postgres-at-the-guardian?contenttype=Article&source=applinks","article:publisher":"https://www.facebook.com/theguardian","og:title":"Aurora Serverless – a migration story","fb:app_id":"180444840287","article:modified_time":"2023-08-16T16:03:03.000Z","og:image:height":"720","og:description":"On our team we swapped databases 6 times in a year. We’ve landed on Aurora Serverless V2 – was it worth it?","og:type":"article","al:ios:app_store_id":"409128287","article:section":"Info","article:published_time":"2023-08-16T08:46:04.000Z","article:tag":"","al:ios:app_name":"The Guardian","og:site_name":"the Guardian"},"twitterData":{"twitter:app:id:iphone":"409128287","twitter:app:name:googleplay":"The Guardian","twitter:app:name:ipad":"The Guardian","twitter:card":"summary_large_image","twitter:app:name:iphone":"The Guardian","twitter:app:id:ipad":"409128287","twitter:app:id:googleplay":"com.guardian","twitter:app:url:googleplay":"guardian://www.theguardian.com/info/2023/aug/16/serverless-postgres-at-the-guardian","twitter:app:url:iphone":"gnmguardian://info/2023/aug/16/serverless-postgres-at-the-guardian?contenttype=Article&source=twitter","twitter:image":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1200&height=630&quality=85&auto=format&fit=crop&overlay-align=bottom%2Cleft&overlay-width=100p&overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctYWdlLTIwMjMucG5n&s=99894b47dc27d815ffc4ace7736aa317","twitter:site":"@guardian","twitter:app:url:ipad":"gnmguardian://info/2023/aug/16/serverless-postgres-at-the-guardian?contenttype=Article&source=twitter"},"config":{"switches":{"lightbox":true,"abPrebidKeywords":true,"personaliseSignInGateAfterCheckout":true,"abSignInGateMainVariant":true,"prebidAppnexusUkRow":true,"prebidMagnite":true,"commercialMetrics":true,"prebidTrustx":true,"scAdFreeBanner":false,"adaptiveSite":true,"prebidPermutiveAudience":true,"compareVariantDecision":false,"enableSentryReporting":true,"lazyLoadContainers":true,"ampArticleSwitch":false,"remarketing":true,"articleEndSlot":true,"keyEventsCarousel":true,"registerWithPhone":false,"darkModeWeb":true,"targeting":true,"remoteHeader":true,"slotBodyEnd":true,"ampPrebidOzone":false,"extendedMostPopularFronts":true,"emailInlineInFooter":true,"showNewPrivacyWordingOnEmailSignupEmbeds":true,"prebidAnalytics":true,"extendedMostPopular":true,"ampContentAbTesting":false,"prebidCriteo":true,"okta":true,"imrWorldwide":true,"acast":true,"twitterUwt":true,"abAuxiaSignInGate":false,"abDeferPermutiveLoad":true,"prebidAppnexusInvcode":true,"ampPrebidPubmatic":false,"a9HeaderBidding":true,"prebidAppnexus":true,"enableDiscussionSwitch":true,"prebidXaxis":true,"stickyVideos":true,"interactiveFullHeaderSwitch":true,"discussionAllPageSize":true,"prebidUserSync":true,"audioOnwardJourneySwitch":true,"abMovePermutiveSegmentation":false,"brazeTaylorReport":false,"externalVideoEmbeds":true,"abTheTradeDesk":true,"callouts":true,"sentinelLogger":true,"geoMostPopular":true,"weAreHiring":false,"relatedContent":true,"thirdPartyEmbedTracking":true,"prebidOzone":true,"ampLiveblogSwitch":false,"ampAmazon":false,"prebidAdYouLike":true,"mostViewedFronts":true,"optOutAdvertising":true,"abSignInGateMainControl":true,"googleSearch":true,"abOptOutFrequencyCap":true,"brazeSwitch":true,"prebidKargo":true,"consentManagement":true,"idProfileNavigation":true,"confiantAdVerification":true,"discussionAllowAnonymousRecommendsSwitch":false,"dcrCrosswords":true,"absoluteServerTimes":false,"permutive":true,"comscore":true,"ampPrebidCriteo":false,"prebidTheTradeDesk":true,"loopVideoTest":false,"newsletterOnwards":false,"youtubeIma":true,"webFonts":true,"liveBlogTopSponsorship":true,"abAdBlockAsk":false,"ophan":true,"crosswordSvgThumbnails":true,"prebidTriplelift":true,"prebidPubmatic":true,"serverShareCounts":false,"autoRefresh":true,"enhanceTweets":true,"prebidIndexExchange":true,"prebidOpenx":true,"prebidHeaderBidding":true,"idCookieRefresh":true,"discussionPageSize":true,"smartAppBanner":false,"historyTags":true,"brazeContentCards":true,"remoteBanner":true,"emailSignupRecaptcha":true,"prebidSmart":true,"shouldLoadGoogletag":true,"inizio":true,"europeBetaFront":true},"abTests":{},"googletagUrl":"//securepubads.g.doubleclick.net/tag/js/gpt.js","stage":"PROD","frontendAssetsFullURL":"https://assets.guim.co.uk/","ampIframeUrl":"https://assets.guim.co.uk/data/vendor/2533d5cb94302889e6a8f1b24b5329e7/amp-iframe.html","tones":"","facebookIaAdUnitRoot":"facebook-instant-articles","avatarApiUrl":"https://avatar.theguardian.com","isSplash":false,"isColumn":false,"membershipUrl":"https://membership.theguardian.com","headline":"Aurora Serverless – a migration story","isImmersive":false,"author":"Philip McMahon","ipsosTag":"guardian","isProd":true,"series":"Engineering blog","toneIds":"","membershipAccess":"","allowUserGeneratedContent":false,"commissioningDesks":"","webPublicationDate":1692175564000,"forecastsapiurl":"/weatherapi/forecast","supportUrl":"https://support.theguardian.com","isNumberedList":false,"commercialBundleUrl":"https://assets.guim.co.uk/commercial/47e59a6f2531251d895a/graun.standalone.commercial.js","idOAuthUrl":"https://oauth.theguardian.com","webTitle":"Aurora Serverless – a migration story","isPhotoEssay":false,"idWebAppUrl":"https://oauth.theguardian.com","a9PublisherId":"3722","isFront":false,"inBodyInternalLinkCount":2,"googleSearchUrl":"//www.google.co.uk/cse/cse.js","inBodyExternalLinkCount":12,"showRelatedContent":true,"lightboxImages":{"id":"info/2023/aug/16/serverless-postgres-at-the-guardian","headline":"Aurora Serverless – a migration story","shouldHideAdverts":false,"standfirst":"<p>On our team we swapped databases 6 times in a year. We’ve landed on Aurora Serverless V2 – was it worth it?</p>","images":[{"caption":"It’s not all sunshine up there in the cloud.","credit":"Photograph: Geoffrey Swaine/Shutterstock","displayCredit":true,"src":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=700&quality=85&auto=format&fit=max&s=ec94a05666b351a7853aef0fc2bbdd5c","srcsets":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1920&quality=85&auto=format&fit=max&s=4c7f808d35952ab636cacf6e24df9f25 1920w, https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1225&quality=85&auto=format&fit=max&s=d806c206092755d16cce68eac8069c10 1225w, https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=1065&quality=85&auto=format&fit=max&s=97e22cf14d4317474000c3b545749f01 1065w, https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=965&quality=85&auto=format&fit=max&s=e157c4012a23d8c1baa1a392bb535ea9 965w, https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=725&quality=85&auto=format&fit=max&s=ce2858dddf7c6bc5dfe44d74c7ff8cff 725w, https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=645&quality=85&auto=format&fit=max&s=afc940028d2aaa969b49090e7811352b 645w, https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/master/5472.jpg?width=465&quality=85&auto=format&fit=max&s=b32e8a37c014b72d4af189b23ed8142a 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":1.6667681998172403,"role":"None","parentContentId":"info/2023/aug/16/serverless-postgres-at-the-guardian","id":"info/2023/aug/16/serverless-postgres-at-the-guardian"},{"caption":"Architecture diagram of Lurch application","credit":"Illustration: Philip McMahon","displayCredit":false,"src":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=700&quality=85&auto=format&fit=max&s=79cda5d89a68f7578c308d6162426fd9","srcsets":"https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1920&quality=85&auto=format&fit=max&s=99298edb757cc17fb3c210da24391f97 1920w, https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1225&quality=85&auto=format&fit=max&s=7c02ab47b7c9c32ac700171637e2d279 1225w, https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=1065&quality=85&auto=format&fit=max&s=be3256534953aae30e2cacb024bd3fc1 1065w, https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=965&quality=85&auto=format&fit=max&s=de914b51ac822f553904ee144693af41 965w, https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=725&quality=85&auto=format&fit=max&s=14316db768b456d9dc9d6c19d348b6e0 725w, https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=645&quality=85&auto=format&fit=max&s=932366bd087c26b1e50b033ea120da70 645w, https://i.guim.co.uk/img/media/aaae4cc46a008f2623a564b8e2dbea024f675b0a/0_0_1599_469/master/1599.jpg?width=465&quality=85&auto=format&fit=max&s=56783aa891b0e955cb0939266ed67a0c 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":3.4093816631130065,"role":"None","parentContentId":"info/2023/aug/16/serverless-postgres-at-the-guardian","id":"info/2023/aug/16/serverless-postgres-at-the-guardian"},{"caption":"The aurora borealis – not to be confused with a pile of VMs somewhere in eu-west-1.","credit":"Photograph: Peter Summers/Getty Images","displayCredit":true,"src":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=700&quality=85&auto=format&fit=max&s=78c7f0f7c8153642446f16197fb9f585","srcsets":"https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1920&quality=85&auto=format&fit=max&s=1ae204ff821300e191e82e69c38ba1a2 1920w, https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1225&quality=85&auto=format&fit=max&s=ddfea45f4feb715577563ea040f69105 1225w, https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=1065&quality=85&auto=format&fit=max&s=9fa966b17502b788dee542a2721ea89d 1065w, https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=965&quality=85&auto=format&fit=max&s=cb6b1cc98bcc03fae5695dc94acbabe9 965w, https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=725&quality=85&auto=format&fit=max&s=6e19db6ef4a080826d94a27f3992a5d0 725w, https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=645&quality=85&auto=format&fit=max&s=98457320413ff88503188d071846f1a3 645w, https://i.guim.co.uk/img/media/248244af7d5ac1f4ad81f031e02f42da4e6dbfa6/0_233_3499_2100/master/3499.jpg?width=465&quality=85&auto=format&fit=max&s=409dca9b8b6ffd242c2285bea5412ffd 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":1.6661904761904762,"role":"None","parentContentId":"info/2023/aug/16/serverless-postgres-at-the-guardian","id":"info/2023/aug/16/serverless-postgres-at-the-guardian"},{"caption":"Costs table for the different stages of aurora serverless migration","credit":"Illustration: Philip McMahon/The Guardian","displayCredit":false,"src":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=700&quality=85&auto=format&fit=max&s=b7e7495ef5dd1c2ffa1c7024f204be88","srcsets":"https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1920&quality=85&auto=format&fit=max&s=da303f785a3128a653416ba498da47b1 1920w, https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1225&quality=85&auto=format&fit=max&s=9032d2f8312830c98ae314b68fd2ac06 1225w, https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=1065&quality=85&auto=format&fit=max&s=68bc79294d489ac844e1708cd34564dd 1065w, https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=965&quality=85&auto=format&fit=max&s=376b51c3cde5d74e16779519270d99bc 965w, https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=725&quality=85&auto=format&fit=max&s=96bea1b8237b3a3d2a15bc81871d6a39 725w, https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=645&quality=85&auto=format&fit=max&s=09c0d335f2da837b6806f9e7741801df 645w, https://i.guim.co.uk/img/media/f4875ba032f28d6d46fca79ad84d43baa2e96231/0_0_1942_520/master/1942.jpg?width=465&quality=85&auto=format&fit=max&s=ec1279424bfceccf76969aa37746e710 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":3.7346153846153847,"role":"None","parentContentId":"info/2023/aug/16/serverless-postgres-at-the-guardian","id":"info/2023/aug/16/serverless-postgres-at-the-guardian"}]},"googleSearchId":"007466294097402385199:m2ealvuxh1i","shouldHideReaderRevenue":false,"idUrl":"https://profile.theguardian.com","hasSurveyAd":false,"omnitureAmpAccount":"guardiangu-thirdpartyapps","dfpAdUnitRoot":"theguardian.com","host":"https://www.theguardian.com","blogIds":"","sectionName":"Info","hasMultipleVideosInPage":false,"hasShowcaseMainElement":false,"googleRecaptchaSiteKey":"6LdzlmsdAAAAALFH63cBVagSFPuuHXQ9OfpIDdMc","fbAppId":"180444840287","isContent":true,"shortUrlId":"/p/npk6a","dfpAccountId":"59666047","plistaPublicApiKey":"462925f4f131001fd974bebe","wordCount":2149,"hasLiveBlogTopAd":false,"dcrSentryDsn":"https://1937ab71c8804b2b8438178dfdd6468f@sentry.io/1377847","cardStyle":"news","adUnit":"/59666047/theguardian.com/info/article/ng","discussionApiUrl":"https://discussion.theguardian.com/discussion-api","isSensitive":false,"ophanEmbedJsUrl":"//j.ophan.co.uk/ophan.embed","edition":"UK","brazeApiKey":"7f28c639-8bda-48ff-a3f6-24345abfc07c","blogs":"","discussionApiClientHeader":"nextgen","section":"info","userAttributesApiUrl":"https://members-data-api.theguardian.com/user-attributes","videoDuration":0,"dfpHost":"pubads.g.doubleclick.net","weatherapiurl":"/weatherapi/city","sentryPublicApiKey":"344003a8d11c41d8800fbad8383fdc50","shortUrl":"https://www.theguardian.com/p/npk6a","thumbnail":"https://i.guim.co.uk/img/media/1bf5f3913840dcb51cb5dd5622d3068771411efc/0_158_5472_3283/500.jpg?quality=85&auto=format&fit=max&s=c453fae2ab6bb767d5580db829b78cfc","pillar":"News","pageId":"info/2023/aug/16/serverless-postgres-at-the-guardian","references":[],"beaconUrl":"//phar.gu-web.net","commentable":false,"discussionD2Uid":"zHoBy6HNKsk","ophanJsUrl":"//j.ophan.co.uk/ophan.ng","contributorBio":"","keywordIds":"","contentType":"Article","isDev":false,"isHosted":false,"isAdFree":false,"stripePublicToken":"pk_live_2O6zPMHXNs2AGea4bAmq5R7Z","omnitureAccount":"guardiangu-network","locationapiurl":"/weatherapi/locations?query=","authorIds":"profile/philip-mcmahon","isPaidContent":false,"hasYouTubeAtom":false,"externalEmbedHost":"https://embed.theguardian.com","thirdPartyAppsAccount":"guardiangu-thirdpartyapps","ajaxUrl":"https://api.nextgen.guardianapps.co.uk","byline":"Philip McMahon","keywords":"","contentId":"info/2023/aug/16/serverless-postgres-at-the-guardian","nonKeywordTagIds":"info/series/engineering-blog,type/article,profile/philip-mcmahon","mobileAppsAdUnitRoot":"beta-guardian-app","hasPageSkin":false,"requiresMembershipAccess":false,"seriesTags":"Engineering blog","revisionNumber":"DEV","seriesId":"info/series/engineering-blog","optimizeEpicUrl":"https://support.theguardian.com/epic/control/index.html","assetsPath":"https://assets.guim.co.uk/","mmaUrl":"https://manage.theguardian.com","isLive":false,"richLink":"","campaigns":[],"isLiveBlog":false,"pageCode":"12729970","avatarImagesUrl":"https://avatar.guim.co.uk","publication":"theguardian.com","sentryHost":"app.getsentry.com/35463","buildNumber":"DEV","userBenefitsApiUrl":"https://user-benefits.guardianapis.com/benefits/me","sharedAdTargeting":{"se":["engineering-blog"],"ct":"article","su":["0"],"edition":"uk","p":"ng","sh":"https://www.theguardian.com/p/npk6a","co":["philip-mcmahon"],"url":"/info/2023/aug/16/serverless-postgres-at-the-guardian"},"onwardWebSocket":"ws://api.nextgen.guardianapps.co.uk/recently-published","productionOffice":"Uk","shouldHideAdverts":false,"idApiUrl":"https://idapi.theguardian.com","pbIndexSites":[{"bp":"D","id":208247},{"bp":"M","id":213519},{"bp":"T","id":215454}],"googletagJsUrl":"//securepubads.g.doubleclick.net/tag/js/gpt.js","calloutsUrl":"https://callouts.guardianapis.com/formstack-campaign/submit","isPreview":false},"guardianBaseURL":"https://www.theguardian.com","contentType":"Article","hasRelated":true,"hasStoryPackage":false,"beaconURL":"//phar.gu-web.net","isCommentable":false,"commercialProperties":{"US":{"adTargeting":[{"name":"co","value":["philip-mcmahon"]},{"name":"su","value":["0"]},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/npk6a"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"},{"name":"url","value":"/info/2023/aug/16/serverless-postgres-at-the-guardian"},{"name":"edition","value":"us"}]},"AU":{"adTargeting":[{"name":"co","value":["philip-mcmahon"]},{"name":"su","value":["0"]},{"name":"edition","value":"au"},{"name":"url","value":"/info/2023/aug/16/serverless-postgres-at-the-guardian"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/npk6a"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"UK":{"adTargeting":[{"name":"co","value":["philip-mcmahon"]},{"name":"su","value":["0"]},{"name":"url","value":"/info/2023/aug/16/serverless-postgres-at-the-guardian"},{"name":"edition","value":"uk"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/npk6a"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"INT":{"adTargeting":[{"name":"co","value":["philip-mcmahon"]},{"name":"su","value":["0"]},{"name":"url","value":"/info/2023/aug/16/serverless-postgres-at-the-guardian"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/npk6a"},{"name":"edition","value":"int"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"EUR":{"adTargeting":[{"name":"co","value":["philip-mcmahon"]},{"name":"su","value":["0"]},{"name":"url","value":"/info/2023/aug/16/serverless-postgres-at-the-guardian"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/npk6a"},{"name":"edition","value":"eur"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]}},"pageType":{"hasShowcaseMainElement":false,"isFront":false,"isLiveblog":false,"isMinuteArticle":false,"isPaidContent":false,"isPreview":false,"isSensitive":false},"trailText":"On our team we swapped databases 6 times in a year. We’ve landed on Aurora Serverless V2 – was it worth it?","nav":{"currentUrl":"/info","pillars":[{"title":"News","url":"/","longTitle":"Headlines","iconName":"home","children":[{"title":"UK","url":"/uk-news","longTitle":"UK news","children":[{"title":"UK politics","url":"/politics"},{"title":"Education","url":"/education","children":[{"title":"Schools","url":"/education/schools"},{"title":"Teachers","url":"/teacher-network"},{"title":"Universities","url":"/education/universities"},{"title":"Students","url":"/education/students"}]},{"title":"Media","url":"/media"},{"title":"Society","url":"/society"},{"title":"Law","url":"/law"},{"title":"Scotland","url":"/uk/scotland"},{"title":"Wales","url":"/uk/wales"},{"title":"Northern Ireland","url":"/uk/northernireland"}]},{"title":"US politics","url":"/us-news/us-politics"},{"title":"World","url":"/world","longTitle":"World news","children":[{"title":"Europe","url":"/world/europe-news"},{"title":"US","url":"/us-news","longTitle":"US news"},{"title":"Americas","url":"/world/americas"},{"title":"Asia","url":"/world/asia"},{"title":"Australia","url":"/australia-news","longTitle":"Australia news"},{"title":"Middle East","url":"/world/middleeast"},{"title":"Africa","url":"/world/africa"},{"title":"Inequality","url":"/inequality"},{"title":"Global development","url":"/global-development"}]},{"title":"Climate crisis","url":"/environment/climate-crisis"},{"title":"Middle East","url":"/world/middleeast"},{"title":"Ukraine","url":"/world/ukraine"},{"title":"Football","url":"/football","children":[{"title":"Live scores","url":"/football/live","longTitle":"football/live"},{"title":"Tables","url":"/football/tables","longTitle":"football/tables"},{"title":"Fixtures","url":"/football/fixtures","longTitle":"football/fixtures"},{"title":"Results","url":"/football/results","longTitle":"football/results"},{"title":"Competitions","url":"/football/competitions","longTitle":"football/competitions"},{"title":"Clubs","url":"/football/teams","longTitle":"football/teams"}]},{"title":"Newsletters","url":"/email-newsletters"},{"title":"Business","url":"/business","children":[{"title":"Economics","url":"/business/economics"},{"title":"Banking","url":"/business/banking"},{"title":"Money","url":"/money","children":[{"title":"Property","url":"/money/property"},{"title":"Pensions","url":"/money/pensions"},{"title":"Savings","url":"/money/savings"},{"title":"Borrowing","url":"/money/debt"},{"title":"Careers","url":"/money/work-and-careers"}]},{"title":"Markets","url":"/business/stock-markets"},{"title":"Project Syndicate","url":"/business/series/project-syndicate-economists"},{"title":"B2B","url":"/business-to-business"},{"title":"Retail","url":"/business/retail"}]},{"title":"Environment","url":"/environment","children":[{"title":"Climate crisis","url":"/environment/climate-crisis"},{"title":"Wildlife","url":"/environment/wildlife"},{"title":"Energy","url":"/environment/energy"},{"title":"Pollution","url":"/environment/pollution"}]},{"title":"UK politics","url":"/politics"},{"title":"Society","url":"/society"},{"title":"Science","url":"/science"},{"title":"Tech","url":"/technology"},{"title":"Global development","url":"/global-development"},{"title":"Obituaries","url":"/obituaries"}]},{"title":"Opinion","url":"/commentisfree","longTitle":"Opinion home","iconName":"home","children":[{"title":"The Guardian view","url":"/profile/editorial"},{"title":"Columnists","url":"/index/contributors"},{"title":"Cartoons","url":"/tone/cartoons"},{"title":"Opinion videos","url":"/type/video+tone/comment"},{"title":"Letters","url":"/tone/letters"}]},{"title":"Sport","url":"/sport","longTitle":"Sport home","iconName":"home","children":[{"title":"Football","url":"/football","children":[{"title":"Live scores","url":"/football/live","longTitle":"football/live"},{"title":"Tables","url":"/football/tables","longTitle":"football/tables"},{"title":"Fixtures","url":"/football/fixtures","longTitle":"football/fixtures"},{"title":"Results","url":"/football/results","longTitle":"football/results"},{"title":"Competitions","url":"/football/competitions","longTitle":"football/competitions"},{"title":"Clubs","url":"/football/teams","longTitle":"football/teams"}]},{"title":"Cricket","url":"/sport/cricket"},{"title":"Rugby union","url":"/sport/rugby-union"},{"title":"Tennis","url":"/sport/tennis"},{"title":"Cycling","url":"/sport/cycling"},{"title":"F1","url":"/sport/formulaone"},{"title":"Golf","url":"/sport/golf"},{"title":"Boxing","url":"/sport/boxing"},{"title":"Rugby league","url":"/sport/rugbyleague"},{"title":"Racing","url":"/sport/horse-racing"},{"title":"US sports","url":"/sport/us-sport"}]},{"title":"Culture","url":"/culture","longTitle":"Culture home","iconName":"home","children":[{"title":"Film","url":"/film"},{"title":"Music","url":"/music"},{"title":"TV & radio","url":"/tv-and-radio"},{"title":"Books","url":"/books"},{"title":"Art & design","url":"/artanddesign"},{"title":"Stage","url":"/stage"},{"title":"Games","url":"/games"},{"title":"Classical","url":"/music/classicalmusicandopera"}]},{"title":"Lifestyle","url":"/lifeandstyle","longTitle":"Lifestyle home","iconName":"home","children":[{"title":"The Filter","url":"/uk/thefilter"},{"title":"Fashion","url":"/fashion"},{"title":"Food","url":"/food"},{"title":"Recipes","url":"/tone/recipes"},{"title":"Travel","url":"/travel","children":[{"title":"UK","url":"/travel/uk"},{"title":"Europe","url":"/travel/europe"},{"title":"US","url":"/travel/usa"}]},{"title":"Health & fitness","url":"/lifeandstyle/health-and-wellbeing"},{"title":"Women","url":"/lifeandstyle/women"},{"title":"Men","url":"/lifeandstyle/men"},{"title":"Love & sex","url":"/lifeandstyle/love-and-sex"},{"title":"Beauty","url":"/fashion/beauty"},{"title":"Home & garden","url":"/lifeandstyle/home-and-garden"},{"title":"Money","url":"/money","children":[{"title":"Property","url":"/money/property"},{"title":"Pensions","url":"/money/pensions"},{"title":"Savings","url":"/money/savings"},{"title":"Borrowing","url":"/money/debt"},{"title":"Careers","url":"/money/work-and-careers"}]},{"title":"Cars","url":"/technology/motoring"}]}],"otherLinks":[{"title":"The Guardian app","url":"https://app.adjust.com/16xt6hai"},{"title":"Video","url":"/video"},{"title":"Podcasts","url":"/podcasts"},{"title":"Pictures","url":"/inpictures"},{"title":"Newsletters","url":"/email-newsletters"},{"title":"Today's paper","url":"/theguardian","children":[{"title":"Obituaries","url":"/obituaries"},{"title":"G2","url":"/theguardian/g2"},{"title":"Journal","url":"/theguardian/journal"},{"title":"Saturday","url":"/theguardian/saturday"}]},{"title":"Inside the Guardian","url":"https://www.theguardian.com/insidetheguardian"},{"title":"The Observer","url":"/observer","children":[{"title":"Comment","url":"/theobserver/news/comment"},{"title":"The New Review","url":"/theobserver/new-review"},{"title":"Observer Magazine","url":"/theobserver/magazine"},{"title":"Observer Food Monthly","url":"/theobserver/foodmonthly"}]},{"title":"Guardian Weekly","url":"https://www.theguardian.com/weekly?INTCMP=gdnwb_mawns_editorial_gweekly_GW_TopNav_UK"},{"title":"Crosswords","url":"/crosswords","children":[{"title":"Blog","url":"/crosswords/crossword-blog"},{"title":"Quick","url":"/crosswords/series/quick"},{"title":"Speedy","url":"/crosswords/series/speedy"},{"title":"Quick cryptic","url":"/crosswords/series/quick-cryptic"},{"title":"Everyman","url":"/crosswords/series/everyman"},{"title":"Quiptic","url":"/crosswords/series/quiptic"},{"title":"Cryptic","url":"/crosswords/series/cryptic"},{"title":"Prize","url":"/crosswords/series/prize"},{"title":"Azed","url":"/crosswords/series/azed"},{"title":"Genius","url":"/crosswords/series/genius"},{"title":"Weekend","url":"/crosswords/series/weekend-crossword"},{"title":"Special","url":"/crosswords/series/special"}]},{"title":"Wordiply","url":"https://www.wordiply.com"},{"title":"Corrections","url":"/theguardian/series/corrections-and-clarifications"}],"brandExtensions":[{"title":"Search jobs","url":"https://jobs.theguardian.com"},{"title":"Hire with Guardian Jobs","url":"https://recruiters.theguardian.com/?utm_source=gdnwb&utm_medium=navbar&utm_campaign=Guardian_Navbar_Recruiters&CMP_TU=trdmkt&CMP_BUNIT=jobs"},{"title":"Holidays","url":"https://holidays.theguardian.com?INTCMP=holidays_uk_web_newheader"},{"title":"Live events","url":"https://www.theguardian.com/guardian-live-events?INTCMP=live_uk_header_dropdown"},{"title":"About Us","url":"/about"},{"title":"Digital Archive","url":"https://theguardian.newspapers.com"},{"title":"Guardian Print Shop","url":"/artanddesign/series/gnm-print-sales"},{"title":"Patrons","url":"https://patrons.theguardian.com/?INTCMP=header_patrons"},{"title":"Guardian Licensing","url":"https://licensing.theguardian.com/"}],"readerRevenueLinks":{"header":{"contribute":"https://support.theguardian.com/contribute?INTCMP=header_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=header_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=header_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=header_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_supporter_cta%22%7D"},"footer":{"contribute":"https://support.theguardian.com/contribute?INTCMP=footer_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=footer_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=footer_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=footer_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_supporter_cta%22%7D"},"sideMenu":{"contribute":"https://support.theguardian.com/contribute?INTCMP=side_menu_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=side_menu_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=side_menu_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=mobilenav_print_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22mobilenav_print_cta%22%7D"},"ampHeader":{"contribute":"https://support.theguardian.com/contribute?INTCMP=header_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=header_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=amp_header_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22amp_header_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=header_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_supporter_cta%22%7D"},"ampFooter":{"contribute":"https://support.theguardian.com/contribute?INTCMP=amp_footer_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=amp_footer_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=footer_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=amp_footer_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_supporter_cta%22%7D"}}},"showBottomSocialButtons":true,"pageFooter":{"footerLinks":[[{"text":"About us","url":"/about","dataLinkName":"uk : footer : about us","extraClasses":""},{"text":"Help","url":"https://manage.theguardian.com/help-centre","dataLinkName":"uk : footer : tech feedback","extraClasses":"js-tech-feedback-report"},{"text":"Complaints & corrections","url":"/info/complaints-and-corrections","dataLinkName":"complaints","extraClasses":""},{"text":"SecureDrop","url":"https://www.theguardian.com/securedrop","dataLinkName":"securedrop","extraClasses":""},{"text":"Work for us","url":"https://workforus.theguardian.com","dataLinkName":"uk : footer : work for us","extraClasses":""},{"text":"Privacy policy","url":"/info/privacy","dataLinkName":"privacy","extraClasses":""},{"text":"Cookie policy","url":"/info/cookies","dataLinkName":"cookie","extraClasses":""},{"text":"Terms & conditions","url":"/help/terms-of-service","dataLinkName":"terms","extraClasses":""},{"text":"Contact us","url":"/help/contact-us","dataLinkName":"uk : footer : contact us","extraClasses":""}],[{"text":"All topics","url":"/index/subjects/a","dataLinkName":"uk : footer : all topics","extraClasses":""},{"text":"All writers","url":"/index/contributors","dataLinkName":"uk : footer : all contributors","extraClasses":""},{"text":"Modern Slavery Act","url":"https://uploads.guim.co.uk/2024/09/04/Modern_Slavery_Statement_2024_.pdf","dataLinkName":"uk : footer : modern slavery act statement","extraClasses":""},{"text":"Tax strategy","url":"https://uploads.guim.co.uk/2024/08/27/TAX_STRATEGY_FOR_THE_YEAR_ENDED_31_MARCH_2025.pdf","dataLinkName":"uk : footer : tax strategy","extraClasses":""},{"text":"Digital newspaper archive","url":"https://theguardian.newspapers.com","dataLinkName":"digital newspaper archive","extraClasses":""},{"text":"Facebook","url":"https://www.facebook.com/theguardian","dataLinkName":"uk : footer : facebook","extraClasses":""},{"text":"YouTube","url":"https://www.youtube.com/user/TheGuardian","dataLinkName":"uk : footer : youtube","extraClasses":""},{"text":"Instagram","url":"https://www.instagram.com/guardian","dataLinkName":"uk : footer : instagram","extraClasses":""},{"text":"LinkedIn","url":"https://www.linkedin.com/company/theguardian","dataLinkName":"uk : footer : linkedin","extraClasses":""},{"text":"Newsletters","url":"/email-newsletters?INTCMP=DOTCOM_FOOTER_NEWSLETTER_UK","dataLinkName":"uk : footer : newsletters","extraClasses":""}],[{"text":"Advertise with us","url":"https://advertising.theguardian.com","dataLinkName":"uk : footer : advertise with us","extraClasses":""},{"text":"Guardian Labs","url":"/guardian-labs","dataLinkName":"uk : footer : guardian labs","extraClasses":""},{"text":"Search jobs","url":"https://jobs.theguardian.com","dataLinkName":"uk : footer : jobs","extraClasses":""},{"text":"Patrons","url":"https://patrons.theguardian.com?INTCMP=footer_patrons","dataLinkName":"uk : footer : patrons","extraClasses":""}]]},"publication":"theguardian.com","shouldHideReaderRevenue":false,"slotMachineFlags":"","contributionsServiceUrl":"https://contributions.guardianapis.com","isSpecialReport":false,"showTableOfContents":false,"lang":"en","isRightToLeftLang":false}