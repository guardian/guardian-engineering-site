{"version":3,"headline":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","standfirst":"<p>How the Guardian’s real time analytics tool pivoted from ElasticSearch Rollups to BigQuery and what we learnt along the way</p>","webTitle":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","mainMediaElements":[{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"1200","width":"2000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/2000.jpg"},{"index":1,"fields":{"height":"600","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/1000.jpg"},{"index":2,"fields":{"height":"300","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/500.jpg"},{"index":3,"fields":{"height":"84","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/140.jpg"},{"index":4,"fields":{"height":"2419","width":"4031"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/4031.jpg"},{"index":5,"fields":{"isMaster":"true","height":"2419","width":"4031"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg"}]},"elementId":"2e818f47-39f9-4d3c-80f7-9b604dad1c3b","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=620&quality=85&auto=format&fit=max&s=950c96f3c5e2eaf98834a17a9a1f1482","width":620},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=237885a2e2ed890dfb98d0b179a2aad1","width":1240},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=85&auto=format&fit=max&s=d053c8102e1fbfd3eb0ea0d3ed94f5d2","width":700},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=45&auto=format&fit=max&dpr=2&s=814d845f96b5709bd2db85a6787a3ad3","width":1400},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=620&quality=85&auto=format&fit=max&s=950c96f3c5e2eaf98834a17a9a1f1482","width":620},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=237885a2e2ed890dfb98d0b179a2aad1","width":1240},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=645&quality=85&auto=format&fit=max&s=5e1543ef1fed949f8dc106972ab12bdb","width":645},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=645&quality=45&auto=format&fit=max&dpr=2&s=ab3e5824162d1c07f867830a9818803c","width":1290},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=465&quality=85&auto=format&fit=max&s=5b557db34d0b2b11688a3d5438b94fc2","width":465},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=465&quality=45&auto=format&fit=max&dpr=2&s=4729c8e9d3dc0c0e5dae2ac6bc1e1aa8","width":930}]},{"weighting":"thumbnail","srcSet":[]},{"weighting":"supporting","srcSet":[]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1020&quality=85&auto=format&fit=max&s=72af819d1a2326acb67e44609ea301d9","width":1020},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1020&quality=45&auto=format&fit=max&dpr=2&s=df7f9695cbeca2382c4a8fc35ea48d38","width":2040},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=940&quality=85&auto=format&fit=max&s=34eb85275d56feedfa534367ba5a720f","width":940},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=940&quality=45&auto=format&fit=max&dpr=2&s=ac4501fdc6ecb1672867b85bf69dccd1","width":1880},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=85&auto=format&fit=max&s=d053c8102e1fbfd3eb0ea0d3ed94f5d2","width":700},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=45&auto=format&fit=max&dpr=2&s=814d845f96b5709bd2db85a6787a3ad3","width":1400},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=85&auto=format&fit=max&s=d053c8102e1fbfd3eb0ea0d3ed94f5d2","width":700},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=45&auto=format&fit=max&dpr=2&s=814d845f96b5709bd2db85a6787a3ad3","width":1400},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=660&quality=85&auto=format&fit=max&s=a0703db1e5fa633906a9db6705538d13","width":660},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=5c8694d1b65336f3714b478968419279","width":1320},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=645&quality=85&auto=format&fit=max&s=5e1543ef1fed949f8dc106972ab12bdb","width":645},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=645&quality=45&auto=format&fit=max&dpr=2&s=ab3e5824162d1c07f867830a9818803c","width":1290},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=465&quality=85&auto=format&fit=max&s=5b557db34d0b2b11688a3d5438b94fc2","width":465},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=465&quality=45&auto=format&fit=max&dpr=2&s=4729c8e9d3dc0c0e5dae2ac6bc1e1aa8","width":930}]},{"weighting":"halfwidth","srcSet":[]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1900&quality=85&auto=format&fit=max&s=b028bda3e89d35d49bded89525de1f3f","width":1900},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=b82debeb436dd04380cdc6aa21fb6d02","width":3800},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1300&quality=85&auto=format&fit=max&s=85054ecf55fc83ddb272a32dcc4ea85c","width":1300},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=9677fe40cf4b2bc4ca3885306625b065","width":2600},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1140&quality=85&auto=format&fit=max&s=89f475684ed8453d334f2dddf6f986ea","width":1140},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=62f7f47c61795fd51d121ce42417ea31","width":2280},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=980&quality=85&auto=format&fit=max&s=c0de360ce5317f6ecd6b3918177151c3","width":980},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=66b18bcf83479c0bdd38a82b9d8e5e2c","width":1960},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=740&quality=85&auto=format&fit=max&s=ee49d5fad37320a8d63da2c86c7bb2f5","width":740},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=529a20594891713edfc975f6a6de54d3","width":1480},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=660&quality=85&auto=format&fit=max&s=a0703db1e5fa633906a9db6705538d13","width":660},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=5c8694d1b65336f3714b478968419279","width":1320},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=480&quality=85&auto=format&fit=max&s=860cf476e05628f6b73b32b236a97270","width":480},{"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=6b84a4cc86bf612d3b8d583f63cfab9e","width":960}]}],"data":{"alt":"Ophan analytics dashboard","caption":"Ophan analytics dashboard","credit":"Photograph: Tom Grinsted/The Guardian"}}],"main":"<figure class=\"element element-image\" data-media-id=\"138aadf062534a90b34ca606967b15ae7bd139a7\"> <img src=\"https://media.guim.co.uk/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/1000.jpg\" alt=\"Ophan analytics dashboard\" width=\"1000\" height=\"600\" class=\"gu-image\" /> <figcaption> <span class=\"element-image__caption\">Ophan analytics dashboard</span> <span class=\"element-image__credit\">Photograph: Tom Grinsted/The Guardian</span> </figcaption> </figure>","filterKeyEvents":false,"keyEvents":[],"blocks":[{"id":"64803c928f083b98d0d4f477","elements":[{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Ophan is the Guardian’s in-house developed real time analytics tool which allows us to see how our content is performing in real-time, providing our Editorial teams with the insights they need to curate and promote our journalism. Its intuitive ways of monitoring reader engagement with content help the teams to evaluate whether it’s performing optimally.</p>","elementId":"1f9ad9fe-4bbf-4ac7-8280-0996120df08d"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Ophan’s distinguishing feature has always been to provide journalists with visualised real time pageview information, with features based on the previous two weeks. More recently <a href=\"https://www.theguardian.com/info/2021/jul/12/how-we-backfilled-the-guardians-in-house-analytics-tool-to-provide-greater-journalistic-insight\">we have expanded these capabilities</a> to provide insights for wider timescales with years of data available at their fingertips.</p>","elementId":"2de6f138-ae3e-4270-a41f-1fb5bf22ec4c"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>This longer term feature set is referred to as “Historical Data” and seeks to provide Editorial with visibility of how a section, desk or topic is performing over time. This will empower our editors to think strategically in a data informed way. So far, we have delivered the ability to view pageview information for a specific article across years, but we have ambitions to take this further.</p>","elementId":"7395b6ec-2122-4fee-9799-a24b3cec2162"},{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"927","width":"1545"},"mediaType":"Image","mimeType":"image/png","url":"https://media.guim.co.uk/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/1545.png"},{"index":1,"fields":{"isMaster":"true","height":"927","width":"1545"},"mediaType":"Image","mimeType":"image/png","url":"https://media.guim.co.uk/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png"},{"index":2,"fields":{"height":"600","width":"1000"},"mediaType":"Image","mimeType":"image/png","url":"https://media.guim.co.uk/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/1000.png"},{"index":3,"fields":{"height":"300","width":"500"},"mediaType":"Image","mimeType":"image/png","url":"https://media.guim.co.uk/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/500.png"},{"index":4,"fields":{"height":"84","width":"140"},"mediaType":"Image","mimeType":"image/png","url":"https://media.guim.co.uk/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/140.png"}]},"elementId":"dd2a9ce1-1292-4d8e-8011-f2964250533b","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=85&auto=format&fit=max&s=3c47981d2615ae7541b2ca36b8e966a9","width":620},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=3061f69aa19c22ec79dc08b0170eab8c","width":1240},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=85&auto=format&fit=max&s=6bad70456827df6c1ae712570f8a83a3","width":605},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=8040bbf73f872beba381d9d5e0af5ce3","width":1210},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=85&auto=format&fit=max&s=d11ed82b180809ea2f2124e5b3675fa8","width":445},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=071901df109c88ae806a48e741e0a7c2","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=140&quality=85&auto=format&fit=max&s=0adcae68beb04f6c160a88ccdd9aafd8","width":140},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=140&quality=45&auto=format&fit=max&dpr=2&s=51bb25e0b961b7c0a8cc807c2d60fd7d","width":280},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=120&quality=85&auto=format&fit=max&s=250a3f65f8e180aef72833ed5f901743","width":120},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=120&quality=45&auto=format&fit=max&dpr=2&s=a5a934088d8164bd84729c3d3494aeb0","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=380&quality=85&auto=format&fit=max&s=92c05640d7e091f56b6004c8a876fe73","width":380},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=380&quality=45&auto=format&fit=max&dpr=2&s=e664dbb62ed382ba74d7e71f04567463","width":760},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=300&quality=85&auto=format&fit=max&s=1c478660c4d074814d46f65c0125b276","width":300},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=300&quality=45&auto=format&fit=max&dpr=2&s=8340b824fc3637b740e507511d140101","width":600},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=85&auto=format&fit=max&s=3c47981d2615ae7541b2ca36b8e966a9","width":620},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=3061f69aa19c22ec79dc08b0170eab8c","width":1240},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=85&auto=format&fit=max&s=6bad70456827df6c1ae712570f8a83a3","width":605},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=8040bbf73f872beba381d9d5e0af5ce3","width":1210},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=85&auto=format&fit=max&s=d11ed82b180809ea2f2124e5b3675fa8","width":445},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=071901df109c88ae806a48e741e0a7c2","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=860&quality=85&auto=format&fit=max&s=0df80f52ffabe74bc272a9e39e2f17a3","width":860},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=860&quality=45&auto=format&fit=max&dpr=2&s=68ca5048cfe81897812e2444f2fb246f","width":1720},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=780&quality=85&auto=format&fit=max&s=fa9305e80ee4d5f7b8b4f16345c8286c","width":780},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=780&quality=45&auto=format&fit=max&dpr=2&s=7f03b31c78ccbd136e4a4f76f1c9ba1e","width":1560},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=85&auto=format&fit=max&s=3c47981d2615ae7541b2ca36b8e966a9","width":620},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=3061f69aa19c22ec79dc08b0170eab8c","width":1240},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=85&auto=format&fit=max&s=6bad70456827df6c1ae712570f8a83a3","width":605},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=8040bbf73f872beba381d9d5e0af5ce3","width":1210},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=85&auto=format&fit=max&s=d11ed82b180809ea2f2124e5b3675fa8","width":445},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=071901df109c88ae806a48e741e0a7c2","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=85&auto=format&fit=max&s=3c47981d2615ae7541b2ca36b8e966a9","width":620},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=3061f69aa19c22ec79dc08b0170eab8c","width":1240},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=85&auto=format&fit=max&s=6bad70456827df6c1ae712570f8a83a3","width":605},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=8040bbf73f872beba381d9d5e0af5ce3","width":1210},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=85&auto=format&fit=max&s=d11ed82b180809ea2f2124e5b3675fa8","width":445},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=071901df109c88ae806a48e741e0a7c2","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1900&quality=85&auto=format&fit=max&s=f3f4e7b107692ff66de1555bc938ca1a","width":1900},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1900&quality=45&auto=format&fit=max&dpr=2&s=40ca8de7dd6fb0f5fc2579c315983ea4","width":3800},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1300&quality=85&auto=format&fit=max&s=4f36f9a8a67b9da16a1336f33e4bf969","width":1300},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1300&quality=45&auto=format&fit=max&dpr=2&s=ebbc14bc7b8fd20b21a272e95839e504","width":2600},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1140&quality=85&auto=format&fit=max&s=ef0352109d65f1e88cd838f2400931f9","width":1140},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1140&quality=45&auto=format&fit=max&dpr=2&s=51dc6f270942648692fbb2e33b5e1aa9","width":2280},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=980&quality=85&auto=format&fit=max&s=c9a336073958984f86d6aa56ec41c316","width":980},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=980&quality=45&auto=format&fit=max&dpr=2&s=8073c39c11256dd448b139a78d0ffbf1","width":1960},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=740&quality=85&auto=format&fit=max&s=8305a08db008d6390dc124672d0d505b","width":740},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=740&quality=45&auto=format&fit=max&dpr=2&s=5f2c3dc16577ba3927c90a0c1e4d8aab","width":1480},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=660&quality=85&auto=format&fit=max&s=dcc1434ecf11040d6db8253c5105dbe3","width":660},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=660&quality=45&auto=format&fit=max&dpr=2&s=48d2c7d41df7dd4a0d1615712a360b5e","width":1320},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=480&quality=85&auto=format&fit=max&s=c5de95edfeabe91bea608c9ccb2af07b","width":480},{"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=480&quality=45&auto=format&fit=max&dpr=2&s=01d6cbf83da837cedb99f2b063e87e40","width":960}]}],"data":{"alt":"Screenshot of Ophan – article info page.","caption":"Screenshot of Ophan – article info page.","credit":"Photograph: Sam Hession"}},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Ophan’s dashboard is primarily backed by an ElasticSearch data store, which offers the performance and capabilities we need to ingest data and surface the results quickly. The pipeline of pageview data is forked and ingested separately into our temporal ElasticSearch data store, and our BigQuery data warehouse for longer term storage.</p>","elementId":"0f1591c2-8da6-4686-a6e9-f51b393076cd"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>To date, the ambitions of Historical Data has been backed by ElasticSearch Rollups, a feature designed to provide all the benefits of a search optimised data store while reducing the associated storage costs. It works by “summarising old, high-granularity data into a reduced granularity format for long-term storage.” Historical Data is a perfect use case for such a feature set; it would allow us to utilise our existing application code but simply expand the data available. <em>What’s the catch!?</em></p>","elementId":"181cf608-df34-4b21-8980-93b7540e16cc"},{"displayCredit":false,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"289","width":"1600"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/1600.jpg"},{"index":1,"fields":{"isMaster":"true","height":"289","width":"1600"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg"},{"index":2,"fields":{"height":"181","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/1000.jpg"},{"index":3,"fields":{"height":"90","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/500.jpg"},{"index":4,"fields":{"height":"25","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/140.jpg"}]},"elementId":"b7cff98c-6eed-4b9d-b1ec-c0b6f685d14b","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=e3229a1a7a5e7d2364fb7cf5860f4605","width":620},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=c55cdf0c3768e49debbdc6cadfff40c7","width":1240},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=120a583b3d99b415f192cd50536a3e55","width":605},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=5c72cb649cfdc65b72dcdb8b7d74307b","width":1210},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=86e4dee0ad137dbcb796a0e2f7b3eb36","width":445},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=5696057ceedb1cfa92108d816815d5ff","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=140&quality=85&auto=format&fit=max&s=2643fc23f9a1a260a9d92bda7663fde7","width":140},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=140&quality=45&auto=format&fit=max&dpr=2&s=23f2c8cea6446f4dbcc5d70b8bfa7934","width":280},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=120&quality=85&auto=format&fit=max&s=40c882048f9dda0ca5b3c829a554153f","width":120},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=120&quality=45&auto=format&fit=max&dpr=2&s=8b82653df6219ef18e0f35c6676cdae3","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=380&quality=85&auto=format&fit=max&s=d5a3415821bfaf0259273af6a4e64561","width":380},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=380&quality=45&auto=format&fit=max&dpr=2&s=ada0be79edd4ecba4eb4b000e5f77af0","width":760},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=300&quality=85&auto=format&fit=max&s=2d95892c138c5a858fbef7f397c0b6bb","width":300},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=300&quality=45&auto=format&fit=max&dpr=2&s=10fccc080db8ebce1d19bec9b4878f45","width":600},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=e3229a1a7a5e7d2364fb7cf5860f4605","width":620},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=c55cdf0c3768e49debbdc6cadfff40c7","width":1240},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=120a583b3d99b415f192cd50536a3e55","width":605},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=5c72cb649cfdc65b72dcdb8b7d74307b","width":1210},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=86e4dee0ad137dbcb796a0e2f7b3eb36","width":445},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=5696057ceedb1cfa92108d816815d5ff","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=860&quality=85&auto=format&fit=max&s=81bcf0ab6b1f37e96af8b8ffbddb6c59","width":860},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=860&quality=45&auto=format&fit=max&dpr=2&s=e684b5c77e77ad5c496ed3e1e2a866f8","width":1720},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=780&quality=85&auto=format&fit=max&s=ac2ee6d21f9c95f9f1ced049b4ea30ad","width":780},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=780&quality=45&auto=format&fit=max&dpr=2&s=04d6f6e1f27b4d24f96143f9c990b8f0","width":1560},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=e3229a1a7a5e7d2364fb7cf5860f4605","width":620},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=c55cdf0c3768e49debbdc6cadfff40c7","width":1240},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=120a583b3d99b415f192cd50536a3e55","width":605},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=5c72cb649cfdc65b72dcdb8b7d74307b","width":1210},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=86e4dee0ad137dbcb796a0e2f7b3eb36","width":445},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=5696057ceedb1cfa92108d816815d5ff","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=e3229a1a7a5e7d2364fb7cf5860f4605","width":620},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=c55cdf0c3768e49debbdc6cadfff40c7","width":1240},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=120a583b3d99b415f192cd50536a3e55","width":605},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=5c72cb649cfdc65b72dcdb8b7d74307b","width":1210},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=86e4dee0ad137dbcb796a0e2f7b3eb36","width":445},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=5696057ceedb1cfa92108d816815d5ff","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1900&quality=85&auto=format&fit=max&s=cc4519e663cc423695be20df8e662e62","width":1900},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=563e276911820046d23c20ee0093195b","width":3800},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1300&quality=85&auto=format&fit=max&s=befee1931a2e431fe51b14cbbca31851","width":1300},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=a7dede31949b8b30c63d834e31e82ae6","width":2600},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1140&quality=85&auto=format&fit=max&s=9989e355ce127959b63be8d7823ed271","width":1140},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=70392604cc8ba175111856d0e4dc8336","width":2280},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=980&quality=85&auto=format&fit=max&s=e417ae8199f1fcffb1d6505e3dd991d3","width":980},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=a2e9d5e7c67542ca579d73c91662c4ea","width":1960},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=740&quality=85&auto=format&fit=max&s=c6b89848ab8cddb031024beed57cdb94","width":740},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=b58dbcf08865f65f5f0c127bcacf9368","width":1480},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=660&quality=85&auto=format&fit=max&s=03125b06d0754558f0cfd52afcede207","width":660},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=96450504d2e52b1a952d05ebae175cef","width":1320},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=480&quality=85&auto=format&fit=max&s=da5396dd0720ecfa89e29e0b55479145","width":480},{"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=49bac0d9b22f31e80d29e0db9c1c0118","width":960}]}],"data":{"alt":"Screenshot of Elastic Rollup Documentation showing: “This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.”","caption":"Screenshot of Elastic Rollup Documentation.","credit":"Photograph: Sam Hession"}},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>On reflection, the writing was on the wall (<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/7.17/rollup-overview.html\">docs page</a>), the feature is in technical preview. What’s more, it’s been in technical preview since March 2018. ElasticSearch fully acknowledges that the feature is not covered by their service level agreement and that it may be subject to change or even removal moving forward.</p>","elementId":"7196e2e3-1d28-465b-99f1-84202c3d1a09"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Ophan was an early adopter of this feature, given it was such a compelling use case which matched its intentions perfectly. Other possibilities, such as integrating with the data warehouse, were considered but found to be less compelling due to it requiring significant re-architecting at the time. As long as Elastic were continuing to invest in Rollups, Ophan would be a grateful beneficiary. However, over time a lack of investment became evident with significant flaws which have been encountered and unresolved.</p>","elementId":"f9bdaec9-512b-4cca-a858-e6eb8895ef1e"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Despite this, the team was successfully able to work around any limitations and code solutions to problems which were surely on the to-do list at elastic. For instance, see the <a href=\"https://www.theguardian.com/info/2021/jul/12/how-we-backfilled-the-guardians-in-house-analytics-tool-to-provide-greater-journalistic-insight\">work</a> the team did to backfill Rollups, reverse engineering a way to generate rollup documents. In other cases, simply dropping features which were promised out of the box, such as <a href=\"https://github.com/elastic/elasticsearch/issues/50155#issuecomment-588206698\">searching across live and rollup data</a>. Nothing that would significantly inhibit the success of what we were planning to deliver.</p>","elementId":"08658cc5-5162-4151-99a0-a43316f714e9"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Then came the startling revelation, that aggregations performed against rollup documents could provide inaccurate results. In our case, we had a simple requirement: find the best performing pieces of content for a given time frame and order them by a count of pageviews. Our queries would happily return results and those results appeared to be perfectly reasonable, until we compared them with our data warehouse.</p>","elementId":"6f4c0965-19ca-4407-a9d0-697b4db11ee1"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>We found that under some scenarios, we received only 6% of the correct results for a Top 50 query of articles published in 2021. After carefully investigating, we discovered that these inaccuracies were in fact an <a href=\"https://github.com/elastic/elasticsearch/issues/44998#issuecomment-516398322\">implicit part of the way Rollup aggregations are performed</a> and had been known about since 2019. We attempted to contact Elastic, but received no response, despite the acknowledgment of the problem by their engineers. This discovery forced us to reevaluate our architecture for Historical Data, despite having already invested so heavily.</p>","elementId":"719fec88-7aef-4ef3-ab83-834f0f70ef04"},{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"767","width":"1600"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/1600.jpg"},{"index":1,"fields":{"isMaster":"true","height":"767","width":"1600"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg"},{"index":2,"fields":{"height":"479","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/1000.jpg"},{"index":3,"fields":{"height":"240","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/500.jpg"},{"index":4,"fields":{"height":"67","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/140.jpg"}]},"elementId":"41e52c56-3221-4266-9d92-4d9d6e1c0b72","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=2f3c8e50a2e291e4524ead6864c4251e","width":620},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=098d28b78cedac1c2576e0eb1f30e7a0","width":1240},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=72141db32caca99718589df684184877","width":605},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=19671a4bc9d43c4891344c7f8945a6f3","width":1210},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=7155d15171741576e509476be93eb26b","width":445},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=23129d3af5e99d1809749621b5a7f621","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=140&quality=85&auto=format&fit=max&s=b69cc9791fb8f5df2eb39d04bd25fa98","width":140},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=140&quality=45&auto=format&fit=max&dpr=2&s=dbf73025a8dee49a3fd9dc7dbbcc6790","width":280},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=120&quality=85&auto=format&fit=max&s=706afa2146266db5b2f71196db91b6d6","width":120},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=120&quality=45&auto=format&fit=max&dpr=2&s=2ffb8ded063cac24013694bf0007dd15","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=380&quality=85&auto=format&fit=max&s=9e87cd20a81d9af411497bdd67dd29fb","width":380},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=380&quality=45&auto=format&fit=max&dpr=2&s=52b350b2a10c66357f0d9005e90c9b9a","width":760},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=300&quality=85&auto=format&fit=max&s=1d2582d17f6689a89a84a263566fdc37","width":300},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=300&quality=45&auto=format&fit=max&dpr=2&s=8ffa103316d7681a32b73b9ccad62e33","width":600},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=2f3c8e50a2e291e4524ead6864c4251e","width":620},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=098d28b78cedac1c2576e0eb1f30e7a0","width":1240},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=72141db32caca99718589df684184877","width":605},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=19671a4bc9d43c4891344c7f8945a6f3","width":1210},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=7155d15171741576e509476be93eb26b","width":445},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=23129d3af5e99d1809749621b5a7f621","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=860&quality=85&auto=format&fit=max&s=fbd0311ae2cab3c8fc5713ff05f50d66","width":860},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=860&quality=45&auto=format&fit=max&dpr=2&s=409732e014e759d5f5e0325185f75152","width":1720},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=780&quality=85&auto=format&fit=max&s=eda578e27fc256ca37007be01a81daac","width":780},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=780&quality=45&auto=format&fit=max&dpr=2&s=45160ca139c5f769d000f76279372798","width":1560},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=2f3c8e50a2e291e4524ead6864c4251e","width":620},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=098d28b78cedac1c2576e0eb1f30e7a0","width":1240},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=72141db32caca99718589df684184877","width":605},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=19671a4bc9d43c4891344c7f8945a6f3","width":1210},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=7155d15171741576e509476be93eb26b","width":445},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=23129d3af5e99d1809749621b5a7f621","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=2f3c8e50a2e291e4524ead6864c4251e","width":620},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=098d28b78cedac1c2576e0eb1f30e7a0","width":1240},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=72141db32caca99718589df684184877","width":605},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=19671a4bc9d43c4891344c7f8945a6f3","width":1210},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=7155d15171741576e509476be93eb26b","width":445},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=23129d3af5e99d1809749621b5a7f621","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1900&quality=85&auto=format&fit=max&s=ea8672b372eb5a6f05a0b5966a9cf9f4","width":1900},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=42186e3f86183cc6147c9e9cc71e7f82","width":3800},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1300&quality=85&auto=format&fit=max&s=5db452ad1c98fad0fe79fefc0e3482fb","width":1300},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=b0a75dd5034c6e928aa0956d590042b4","width":2600},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1140&quality=85&auto=format&fit=max&s=aba765fe1a9aa32671dcd74f0c60d139","width":1140},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=9de9bc9afba42595c780f43118351c7a","width":2280},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=980&quality=85&auto=format&fit=max&s=e90bf436a99c5759054db2538a939381","width":980},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=ce57ba24e5aa158332ea8d34f4880481","width":1960},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=740&quality=85&auto=format&fit=max&s=3a5cdb7d8b83c43e0eb9c1c2c478c0f6","width":740},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=5283af6ac95a825261f3c05dd6793940","width":1480},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=660&quality=85&auto=format&fit=max&s=a8a62ead95d052ab9f2ebd0756e04855","width":660},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=aac38fb308d97c39659d7813a86fe959","width":1320},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=480&quality=85&auto=format&fit=max&s=c820b5e2e284ee3e252b301fde07ee9a","width":480},{"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=dc8433814d78f09dbbc0903ee0228240","width":960}]}],"data":{"alt":"Screenshot of ElasticSearch Rollup accuracy analysis sheet showing a set of articles; Some appearing in ElasticSearch queries and others not.","caption":"Screenshot of ElasticSearch Rollup accuracy analysis sheet.","credit":"Photograph: Sam Hession"}},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Falling back to an architectural decision record format, the team decided to carefully evaluate our options, revisiting the decision making from the outset of historical data. This was an exercise which proved to be enormously beneficial. Treating our current situation as a decision making process allowed us to take a step back from our narrowly focused perspective and consider the wider opportunities available to us.</p>","elementId":"a6aadad3-0a64-4aa4-977c-b88a1204a430"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Exploring these possibilities prompted us to contact our brilliant colleagues in the Data Tech team and Data &amp; Insights department. This team typically focuses on tooling and analysis to provide insights for the Guardian, not just for pageview data but varying datasets.</p>","elementId":"6d8cf536-28ae-4561-a5e1-67324c242ee6"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Since the time we made the decision to use Rollups, we had moved from a data lake to a proper data warehouse, using BigQuery as a serverless query engine and DBT to model and express different data transformations and aggregations.</p>","elementId":"543ef3d1-f9d2-4b43-a340-ad7c2e3e4323"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The Data Tech team were enthusiastic about the prospect of using that stack to directly support the Ophan dashboard, being a common and well established use case for BigQuery. We found the benefits of this option enthralling, it would allow us to access more data, more freely, removing our reliance on Rollups altogether. So we began a spike to explore basing our existing functionality on a completely separate data source, BigQuery.</p>","elementId":"b095bd05-a210-40b5-ab2d-8c39ac62f321"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Working closely together, we were quickly able to set up a rudimentary integration with BigQuery, allowing our local project to run queries and return results. There were then a few core areas we needed to explore in more depth. Cross-cloud authentication, pre-aggregation, performance and query building.</p>","elementId":"484d1a8e-8292-4635-953a-f1d96fb6221c"},{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"688","width":"1600"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/1600.jpg"},{"index":1,"fields":{"isMaster":"true","height":"688","width":"1600"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg"},{"index":2,"fields":{"height":"430","width":"1000"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/1000.jpg"},{"index":3,"fields":{"height":"215","width":"500"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/500.jpg"},{"index":4,"fields":{"height":"60","width":"140"},"mediaType":"Image","mimeType":"image/jpeg","url":"https://media.guim.co.uk/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/140.jpg"}]},"elementId":"70e26152-c1f3-4c76-96e9-bac22b376dcf","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=13c9339b3e54bc56268ebcbe6e71d45b","width":620},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=660a594b3b8736bc16f8a9ca875568bc","width":1240},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=47117c439de103084411ec297baa2a28","width":605},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=e4dd3e7552814928c969388e13ee5afc","width":1210},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=9194a3d5637a114cc2bc1c5c9eef3c75","width":445},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=f998ca569b42c03345296d2e18928b7c","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=140&quality=85&auto=format&fit=max&s=95033b0a413be1b9050521ebaad2fabe","width":140},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=140&quality=45&auto=format&fit=max&dpr=2&s=264032fb4dc92514591f99f2e80097ab","width":280},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=120&quality=85&auto=format&fit=max&s=0fd1b7718772d951d0e445de3c51067d","width":120},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=120&quality=45&auto=format&fit=max&dpr=2&s=b07da54350eb6b28b1669c9d1beb7c0a","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=380&quality=85&auto=format&fit=max&s=d7291f0cb7d76a1201837179900aa3c3","width":380},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=380&quality=45&auto=format&fit=max&dpr=2&s=86256ba62d0381a504077c7b04b1c402","width":760},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=300&quality=85&auto=format&fit=max&s=19c31660070eda26e60ed65eb881e5e4","width":300},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=300&quality=45&auto=format&fit=max&dpr=2&s=08df3ff3ff1cb42516f0d7d853629ce1","width":600},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=13c9339b3e54bc56268ebcbe6e71d45b","width":620},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=660a594b3b8736bc16f8a9ca875568bc","width":1240},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=47117c439de103084411ec297baa2a28","width":605},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=e4dd3e7552814928c969388e13ee5afc","width":1210},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=9194a3d5637a114cc2bc1c5c9eef3c75","width":445},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=f998ca569b42c03345296d2e18928b7c","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=860&quality=85&auto=format&fit=max&s=e07bdf94c2a9e153a30dedb54320365a","width":860},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=860&quality=45&auto=format&fit=max&dpr=2&s=b268d3f44f8b09c69edb0dacaba87ff5","width":1720},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=780&quality=85&auto=format&fit=max&s=4e69d4239aedf154e83624d3957fa3eb","width":780},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=780&quality=45&auto=format&fit=max&dpr=2&s=1ae001c020804cd930635a0a42b69940","width":1560},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=13c9339b3e54bc56268ebcbe6e71d45b","width":620},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=660a594b3b8736bc16f8a9ca875568bc","width":1240},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=47117c439de103084411ec297baa2a28","width":605},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=e4dd3e7552814928c969388e13ee5afc","width":1210},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=9194a3d5637a114cc2bc1c5c9eef3c75","width":445},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=f998ca569b42c03345296d2e18928b7c","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=85&auto=format&fit=max&s=13c9339b3e54bc56268ebcbe6e71d45b","width":620},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=620&quality=45&auto=format&fit=max&dpr=2&s=660a594b3b8736bc16f8a9ca875568bc","width":1240},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=85&auto=format&fit=max&s=47117c439de103084411ec297baa2a28","width":605},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=605&quality=45&auto=format&fit=max&dpr=2&s=e4dd3e7552814928c969388e13ee5afc","width":1210},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=85&auto=format&fit=max&s=9194a3d5637a114cc2bc1c5c9eef3c75","width":445},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=445&quality=45&auto=format&fit=max&dpr=2&s=f998ca569b42c03345296d2e18928b7c","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1900&quality=85&auto=format&fit=max&s=4eecebd6d346fca9c56fd0b37d61458c","width":1900},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1900&quality=45&auto=format&fit=max&dpr=2&s=3c995f76f696c6538e26c5d2404e1c0c","width":3800},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1300&quality=85&auto=format&fit=max&s=fa10d097efed9acc342c9175dfe75221","width":1300},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1300&quality=45&auto=format&fit=max&dpr=2&s=e991fd30c2bb17452a33d79c3b16c8ad","width":2600},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1140&quality=85&auto=format&fit=max&s=00073bb2a31c5ff753da06e731e2e640","width":1140},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1140&quality=45&auto=format&fit=max&dpr=2&s=e17236336abf0820b261f35e2e5081fa","width":2280},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=980&quality=85&auto=format&fit=max&s=1dd0ccaa8cbb2617d390970970d7a07d","width":980},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=980&quality=45&auto=format&fit=max&dpr=2&s=0eb70247ff3aa2225759ac486a50e072","width":1960},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=740&quality=85&auto=format&fit=max&s=33d034261eacd27cb463d684beef9a54","width":740},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=740&quality=45&auto=format&fit=max&dpr=2&s=9cf88209dc059a3388930356edc3d8a2","width":1480},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=660&quality=85&auto=format&fit=max&s=a1ab116e949c6d1c31e52f577277aacb","width":660},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=660&quality=45&auto=format&fit=max&dpr=2&s=8e424400abfde2946155b0f3aa588a64","width":1320},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=480&quality=85&auto=format&fit=max&s=18e9c61ea8ff387044936436cbb07b1e","width":480},{"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=480&quality=45&auto=format&fit=max&dpr=2&s=18e6825387776701dc35859a9082502f","width":960}]}],"data":{"alt":"Architecture diagram illustrating how guardian views are processed via the Ophan tracking pipeline then stored in BigQuery and ElasticSearch. This data is then read by the Ophan Dashboard. ","caption":"Architecture diagram showing the Ophan dashboard’s use of BigQuery data.","credit":"Photograph: Sam Hession"}},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>After several months of development, we had overcome the initial complexities of this approach:</p>","elementId":"f8825d75-ebdc-4363-b629-fd0ca8c984fd"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<ul>\n <li>\n  <p><strong>Pre-aggregating data</strong></p></li>\n</ul>","elementId":"83c4368e-16ed-490c-950b-110127031653"},{"_type":"model.dotcomrendering.pageElements.BlockquoteBlockElement","html":"<blockquote>\n <p>The amount of data available in the data warehouse makes it prohibitively slow to query and aggregate on the fly. Making use of the existing pre-aggregation SQL we had developed to backfill our Rollups, we were able to set up multiple DAGs in Airflow to periodically pre-aggregate the data and populate our tables. This new approach opened up the possibilities of making greater amounts of data accessible to our users and the flexibility to change our requirements further down the line.</p>\n</blockquote>","elementId":"790655c5-5938-403b-b735-a78d50ef4f54"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<ul>\n <li>\n  <p><strong>Authentication</strong></p></li>\n</ul>","elementId":"431022b7-3ab6-4f3d-8107-7a8147f9193c"},{"_type":"model.dotcomrendering.pageElements.BlockquoteBlockElement","html":"<blockquote>\n <p>Utilising<a href=\"https://cloud.google.com/iam/docs/workload-identity-federation\"> Workload Identity Federation</a>, we were able to implement a keyless cross-cloud authentication system which allowed our instances in AWS to assume GCP service accounts providing the access necessary to query the new data.<br></p>\n</blockquote>","elementId":"fbb4c431-8af2-492e-a300-7f2ae4209427"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<ul>\n <li>\n  <p><strong>Performance optimisation</strong></p></li>\n</ul>","elementId":"5c7de6e7-615c-4824-b2d9-2ca72479aee3"},{"_type":"model.dotcomrendering.pageElements.BlockquoteBlockElement","html":"<blockquote>\n <p>We optimised performance through different ways. First <a href=\"https://cloud.google.com/bigquery/docs/partitioned-tables\">partitioning</a> enabled us to reduce the amount of data being processed unnecessarily when querying. Then using <a href=\"https://cloud.google.com/bigquery/docs/clustered-tables\">table clustering</a> we increased performance by clustering our pageview data by content identifier. Finally, by making dedicated <a href=\"https://cloud.google.com/bigquery/docs/slots\">slot reservations, we were able to offer reliable performance for the queries.</a></p>\n</blockquote>","elementId":"059ad37b-62d5-46b8-a556-154f3e1a02c8"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Building on this new approach, this coming quarter we are seeking to begin anew our endeavour to build out the Historical Data feature set. We will begin where we left off with top performing pieces of content in a given month, but there are a few lessons which will stick with me.</p>","elementId":"28af46c6-1a25-4d7f-815b-de34d346b44b"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>First, be wary of putting your eggs into the technical preview basket. While it may be appropriate at times to invest in technology which is not entirely finished, be prepared for the possibility that it may not come to fruition. Projects can be dropped, found to be over ambitious, or simply people move around. With these possibilities, you need to consider if it’s appropriate to use them as a foundation for your product.</p>","elementId":"e195eb06-fd3a-48f7-bc02-f186b6b2f71e"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Second, the importance of reevaluating your situation when new information comes to light. Having invested so heavily in ElasticSearch Rollups, it was a difficult decision to even consider other architectures. However, when you take a moment to consider the medium and long term implications of your approach, you can realise whether you’re building a solid foundation or creating more problems for yourself in the future.</p>","elementId":"84432788-f0fd-453c-9c3a-bc22126ee50d"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Finally, collaboration. This is a story about the value of collaborating with those around you. The switch to BigQuery would not have been possible without the insight, enthusiasm and effort of engineers across teams and departments. When people work together, great things can happen.</p>","elementId":"7cff69b0-5bd6-4ccb-9ba7-46bff22a3c93"}],"attributes":{"pinned":false,"keyEvent":false,"summary":false},"blockCreatedOn":1686141873000,"blockCreatedOnDisplay":"13.44 BST","blockLastUpdated":1686140844000,"blockLastUpdatedDisplay":"13.27 BST","contributors":[],"primaryDateLine":"Wed 7 Jun 2023 13.44 BST","secondaryDateLine":"Last modified on Fri 21 Jul 2023 08.30 BST"}],"author":{"byline":"Sam Hession"},"byline":"Sam Hession","webPublicationDate":"2023-06-07T12:44:33.000Z","webPublicationDateDeprecated":"2023-06-07T12:44:33.000Z","webPublicationDateDisplay":"Wed 7 Jun 2023 13.44 BST","webPublicationSecondaryDateDisplay":"Last modified on Fri 21 Jul 2023 08.30 BST","editionLongForm":"UK edition","editionId":"UK","pageId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","canonicalUrl":"https://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","format":{"design":"ArticleDesign","theme":"NewsPillar","display":"StandardDisplay"},"designType":"Article","tags":[{"id":"info/series/engineering-blog","type":"Series","title":"Engineering blog"},{"id":"type/article","type":"Type","title":"Article"},{"id":"profile/sam-hession","type":"Contributor","title":"Sam Hession"}],"pillar":"news","isLegacyInteractive":false,"isImmersive":false,"sectionLabel":"","sectionUrl":"","sectionName":"info","subMetaSectionLinks":[{"url":"/info/series/engineering-blog","title":"Engineering blog"}],"subMetaKeywordLinks":[],"shouldHideAds":false,"isAdFreeUser":false,"webURL":"https://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","linkedData":[{"@type":"NewsArticle","@context":"https://schema.org","@id":"https://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","publisher":{"@type":"Organization","@context":"https://schema.org","@id":"https://www.theguardian.com#publisher","name":"The Guardian","url":"https://www.theguardian.com/","logo":{"@type":"ImageObject","url":"https://uploads.guim.co.uk/2018/01/31/TheGuardian_AMP.png","width":190,"height":60},"sameAs":["https://www.facebook.com/theguardian","https://twitter.com/guardian","https://www.youtube.com/user/TheGuardian"]},"isAccessibleForFree":true,"isPartOf":{"@type":["CreativeWork","Product"],"name":"The Guardian","productID":"theguardian.com:basic"},"image":["https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1200&height=630&quality=85&auto=format&fit=crop&overlay-align=bottom%2Cleft&overlay-width=100p&overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctYWdlLTIwMjMucG5n&enable=upscale&s=370b3bbdb45d30e8cec1a0c6754cd62a","https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1200&height=1200&quality=85&auto=format&fit=crop&s=18fbd553aecea46e3deb93710b232caa","https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1200&height=900&quality=85&auto=format&fit=crop&s=8519098ea2a19586d2e7c420c4d2da7d","https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1200&quality=85&auto=format&fit=max&s=47aeb8b4b413c808b63b90006ad860db"],"author":[{"@type":"Person","name":"Sam Hession","sameAs":"https://www.theguardian.com/profile/sam-hession"}],"datePublished":"2023-06-07T12:44:33.000Z","headline":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","dateModified":"2023-07-21T07:30:03.000Z","mainEntityOfPage":"https://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"@type":"WebPage","@context":"https://schema.org","@id":"https://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","potentialAction":{"@type":"ViewAction","target":"android-app://com.guardian/https/www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"}}],"openGraphData":{"og:url":"https://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","article:author":"https://www.theguardian.com/profile/sam-hession","og:image:width":"1200","og:image":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1200&height=630&quality=85&auto=format&fit=crop&overlay-align=bottom%2Cleft&overlay-width=100p&overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctYWdlLTIwMjMucG5n&enable=upscale&s=370b3bbdb45d30e8cec1a0c6754cd62a","al:ios:url":"gnmguardian://info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data?contenttype=Article&source=applinks","article:publisher":"https://www.facebook.com/theguardian","og:title":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","fb:app_id":"180444840287","article:modified_time":"2023-07-21T07:30:03.000Z","og:image:height":"720","og:description":"How the Guardian’s real time analytics tool pivoted from ElasticSearch Rollups to BigQuery and what we learnt along the way","og:type":"article","al:ios:app_store_id":"409128287","article:section":"Info","article:published_time":"2023-06-07T12:44:33.000Z","article:tag":"","al:ios:app_name":"The Guardian","og:site_name":"the Guardian"},"twitterData":{"twitter:app:id:iphone":"409128287","twitter:app:name:googleplay":"The Guardian","twitter:app:name:ipad":"The Guardian","twitter:card":"summary_large_image","twitter:app:name:iphone":"The Guardian","twitter:app:id:ipad":"409128287","twitter:app:id:googleplay":"com.guardian","twitter:app:url:googleplay":"guardian://www.theguardian.com/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","twitter:app:url:iphone":"gnmguardian://info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data?contenttype=Article&source=twitter","twitter:image":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1200&height=630&quality=85&auto=format&fit=crop&overlay-align=bottom%2Cleft&overlay-width=100p&overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctYWdlLTIwMjMucG5n&s=86168d067f8d6f9019055386c225e408","twitter:site":"@guardian","twitter:app:url:ipad":"gnmguardian://info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data?contenttype=Article&source=twitter"},"config":{"switches":{"lightbox":true,"abPrebidKeywords":true,"personaliseSignInGateAfterCheckout":true,"abSignInGateMainVariant":true,"prebidAppnexusUkRow":true,"prebidMagnite":true,"commercialMetrics":true,"prebidTrustx":true,"scAdFreeBanner":false,"adaptiveSite":true,"prebidPermutiveAudience":true,"compareVariantDecision":false,"enableSentryReporting":true,"lazyLoadContainers":true,"ampArticleSwitch":false,"remarketing":true,"articleEndSlot":true,"keyEventsCarousel":true,"registerWithPhone":false,"darkModeWeb":true,"targeting":true,"remoteHeader":true,"slotBodyEnd":true,"ampPrebidOzone":false,"extendedMostPopularFronts":true,"emailInlineInFooter":true,"showNewPrivacyWordingOnEmailSignupEmbeds":true,"prebidAnalytics":true,"extendedMostPopular":true,"ampContentAbTesting":false,"prebidCriteo":true,"okta":true,"imrWorldwide":true,"acast":true,"twitterUwt":true,"abAuxiaSignInGate":false,"abDeferPermutiveLoad":true,"prebidAppnexusInvcode":true,"ampPrebidPubmatic":false,"a9HeaderBidding":true,"prebidAppnexus":true,"enableDiscussionSwitch":true,"prebidXaxis":true,"stickyVideos":true,"interactiveFullHeaderSwitch":true,"discussionAllPageSize":true,"prebidUserSync":true,"audioOnwardJourneySwitch":true,"abMovePermutiveSegmentation":false,"brazeTaylorReport":false,"externalVideoEmbeds":true,"abTheTradeDesk":true,"callouts":true,"sentinelLogger":true,"geoMostPopular":true,"weAreHiring":false,"relatedContent":true,"thirdPartyEmbedTracking":true,"prebidOzone":true,"ampLiveblogSwitch":false,"ampAmazon":false,"prebidAdYouLike":true,"mostViewedFronts":true,"optOutAdvertising":true,"abSignInGateMainControl":true,"googleSearch":true,"abOptOutFrequencyCap":true,"brazeSwitch":true,"prebidKargo":true,"consentManagement":true,"idProfileNavigation":true,"confiantAdVerification":true,"discussionAllowAnonymousRecommendsSwitch":false,"dcrCrosswords":true,"absoluteServerTimes":false,"permutive":true,"comscore":true,"ampPrebidCriteo":false,"prebidTheTradeDesk":true,"loopVideoTest":false,"newsletterOnwards":false,"youtubeIma":true,"webFonts":true,"liveBlogTopSponsorship":true,"abAdBlockAsk":false,"ophan":true,"crosswordSvgThumbnails":true,"prebidTriplelift":true,"prebidPubmatic":true,"serverShareCounts":false,"autoRefresh":true,"enhanceTweets":true,"prebidIndexExchange":true,"prebidOpenx":true,"prebidHeaderBidding":true,"idCookieRefresh":true,"discussionPageSize":true,"smartAppBanner":false,"historyTags":true,"brazeContentCards":true,"remoteBanner":true,"emailSignupRecaptcha":true,"prebidSmart":true,"shouldLoadGoogletag":true,"inizio":true,"europeBetaFront":true},"abTests":{},"googletagUrl":"//securepubads.g.doubleclick.net/tag/js/gpt.js","stage":"PROD","frontendAssetsFullURL":"https://assets.guim.co.uk/","ampIframeUrl":"https://assets.guim.co.uk/data/vendor/2533d5cb94302889e6a8f1b24b5329e7/amp-iframe.html","tones":"","facebookIaAdUnitRoot":"facebook-instant-articles","avatarApiUrl":"https://avatar.theguardian.com","isSplash":false,"isColumn":false,"membershipUrl":"https://membership.theguardian.com","headline":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","isImmersive":false,"author":"Sam Hession","ipsosTag":"guardian","isProd":true,"series":"Engineering blog","toneIds":"","membershipAccess":"","allowUserGeneratedContent":false,"commissioningDesks":"","webPublicationDate":1686141873000,"forecastsapiurl":"/weatherapi/forecast","supportUrl":"https://support.theguardian.com","isNumberedList":false,"commercialBundleUrl":"https://assets.guim.co.uk/commercial/47e59a6f2531251d895a/graun.standalone.commercial.js","idOAuthUrl":"https://oauth.theguardian.com","webTitle":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","isPhotoEssay":false,"idWebAppUrl":"https://oauth.theguardian.com","a9PublisherId":"3722","isFront":false,"inBodyInternalLinkCount":2,"googleSearchUrl":"//www.google.co.uk/cse/cse.js","inBodyExternalLinkCount":7,"showRelatedContent":true,"lightboxImages":{"id":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","headline":"Roll Over Rollups! The Big Future of Ophan’s Historical Data","shouldHideAdverts":false,"standfirst":"<p>How the Guardian’s real time analytics tool pivoted from ElasticSearch Rollups to BigQuery and what we learnt along the way</p>","images":[{"caption":"Ophan analytics dashboard","credit":"Photograph: Tom Grinsted/The Guardian","displayCredit":true,"src":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=700&quality=85&auto=format&fit=max&s=d053c8102e1fbfd3eb0ea0d3ed94f5d2","srcsets":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1920&quality=85&auto=format&fit=max&s=0fd9bf798a7e9ef24ef4e3d557d3c883 1920w, https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1225&quality=85&auto=format&fit=max&s=61155db07cf34ddb8f03e5bf967a4e47 1225w, https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=1065&quality=85&auto=format&fit=max&s=d16bb8f854fa646fbfeac309d47ea2ff 1065w, https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=965&quality=85&auto=format&fit=max&s=1c9c451b13d7942764db411f1e81921e 965w, https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=725&quality=85&auto=format&fit=max&s=80406ab97c321e77d0f5dcf6562c35c9 725w, https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=645&quality=85&auto=format&fit=max&s=5e1543ef1fed949f8dc106972ab12bdb 645w, https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/master/4031.jpg?width=465&quality=85&auto=format&fit=max&s=5b557db34d0b2b11688a3d5438b94fc2 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":1.666391070690368,"role":"None","parentContentId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","id":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"caption":"Screenshot of Ophan – article info page.","credit":"Photograph: Sam Hession","displayCredit":true,"src":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=700&quality=85&auto=format&fit=max&s=9869845e42d0538aac6a669a6352f754","srcsets":"https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1920&quality=85&auto=format&fit=max&s=e23f62a642c574cd1367a730df8137a4 1920w, https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1225&quality=85&auto=format&fit=max&s=d8d7fc76b3a98c6130d390740f197f93 1225w, https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=1065&quality=85&auto=format&fit=max&s=980c530a88ca0f389dc6cd38ad7627db 1065w, https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=965&quality=85&auto=format&fit=max&s=4fcc62d32d11558baab60171599a5e35 965w, https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=725&quality=85&auto=format&fit=max&s=0ef71cae065932482f1cb6324cbd8bb6 725w, https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=645&quality=85&auto=format&fit=max&s=6e042daf836a8759fd16806f318daa90 645w, https://i.guim.co.uk/img/media/f3e16a2b33eef6701f944c6945e4d04130ff54f6/28_0_1545_927/master/1545.png?width=465&quality=85&auto=format&fit=max&s=f3c5bb4c08f6698e79c6fff6193450af 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":1.6666666666666667,"role":"None","parentContentId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","id":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"caption":"Screenshot of Elastic Rollup Documentation.","credit":"Photograph: Sam Hession","displayCredit":false,"src":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=700&quality=85&auto=format&fit=max&s=979eea6b980afc69c8f0163c67677c73","srcsets":"https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1920&quality=85&auto=format&fit=max&s=101820e9aadc2a07a7552e60f48dcc32 1920w, https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1225&quality=85&auto=format&fit=max&s=85eb08ac7f108ad38a57d4756d5eeb5a 1225w, https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=1065&quality=85&auto=format&fit=max&s=6696136ce045a7f1b5281ec7a787892d 1065w, https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=965&quality=85&auto=format&fit=max&s=997d211add4b1807e8df3dba9376a2c0 965w, https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=725&quality=85&auto=format&fit=max&s=3758e40166c02e7f596cbd6240413b5a 725w, https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=645&quality=85&auto=format&fit=max&s=354d2584e8869a6edaa99056089422fe 645w, https://i.guim.co.uk/img/media/cb2c63f9465336d6c8bc0f1c325648515d49efd4/0_0_1600_289/master/1600.jpg?width=465&quality=85&auto=format&fit=max&s=2f94ed071a142f9b4d015e7c8485321a 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":5.536332179930795,"role":"None","parentContentId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","id":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"caption":"Screenshot of ElasticSearch Rollup accuracy analysis sheet.","credit":"Photograph: Sam Hession","displayCredit":true,"src":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=700&quality=85&auto=format&fit=max&s=e6e321e52e7907bbfb6fbff51b17bf70","srcsets":"https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1920&quality=85&auto=format&fit=max&s=f81b0b7510d1fcc4fbfefa4956408205 1920w, https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1225&quality=85&auto=format&fit=max&s=b0229392b740495328b7a7c8f7be1bd0 1225w, https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=1065&quality=85&auto=format&fit=max&s=761c20cb8377daf7f7be53fc7ae27380 1065w, https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=965&quality=85&auto=format&fit=max&s=13eb63dd5844d8a324d59258abd94ebc 965w, https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=725&quality=85&auto=format&fit=max&s=afa8ad4ef274ec1cd4864203e9200412 725w, https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=645&quality=85&auto=format&fit=max&s=1ab9dbc9c910443bf7d9b42e94d4afab 645w, https://i.guim.co.uk/img/media/ae57bea8a16429578f0314878c6e14b8e8c13d2e/0_0_1600_767/master/1600.jpg?width=465&quality=85&auto=format&fit=max&s=16404c91e56d58f812b5e10c4ffbf87b 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":2.0860495436766624,"role":"None","parentContentId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","id":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"caption":"Architecture diagram showing the Ophan dashboard’s use of BigQuery data.","credit":"Photograph: Sam Hession","displayCredit":true,"src":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=700&quality=85&auto=format&fit=max&s=b75234147630f56d6455bb3fa3074425","srcsets":"https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1920&quality=85&auto=format&fit=max&s=248021d3153b8ec39b6aa7d1773bfaf7 1920w, https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1225&quality=85&auto=format&fit=max&s=8cefc407ac7f9627df16e63bd25961bb 1225w, https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=1065&quality=85&auto=format&fit=max&s=2fbd9eb0e4dbc412267bb975bd8e74f8 1065w, https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=965&quality=85&auto=format&fit=max&s=1e03a7b77fb76cc430141a1f3d4474f3 965w, https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=725&quality=85&auto=format&fit=max&s=87747388ca763e9ddc7c8f96d8daad56 725w, https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=645&quality=85&auto=format&fit=max&s=36e24fb9eb4e4d7a02918fe2cacc1c29 645w, https://i.guim.co.uk/img/media/1640348ea5623227231f5bd2a8a88cfd8a7dd43a/0_0_1600_688/master/1600.jpg?width=465&quality=85&auto=format&fit=max&s=83a3dd05480b0c098083d061c6fe312f 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":2.3255813953488373,"role":"None","parentContentId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","id":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"}]},"googleSearchId":"007466294097402385199:m2ealvuxh1i","shouldHideReaderRevenue":false,"idUrl":"https://profile.theguardian.com","hasSurveyAd":false,"omnitureAmpAccount":"guardiangu-thirdpartyapps","dfpAdUnitRoot":"theguardian.com","host":"https://www.theguardian.com","blogIds":"","sectionName":"Info","hasMultipleVideosInPage":false,"hasShowcaseMainElement":false,"googleRecaptchaSiteKey":"6LdzlmsdAAAAALFH63cBVagSFPuuHXQ9OfpIDdMc","fbAppId":"180444840287","isContent":true,"shortUrlId":"/p/z6tbp","dfpAccountId":"59666047","plistaPublicApiKey":"462925f4f131001fd974bebe","wordCount":1387,"hasLiveBlogTopAd":false,"dcrSentryDsn":"https://1937ab71c8804b2b8438178dfdd6468f@sentry.io/1377847","cardStyle":"news","adUnit":"/59666047/theguardian.com/info/article/ng","discussionApiUrl":"https://discussion.theguardian.com/discussion-api","isSensitive":false,"ophanEmbedJsUrl":"//j.ophan.co.uk/ophan.embed","edition":"UK","brazeApiKey":"7f28c639-8bda-48ff-a3f6-24345abfc07c","blogs":"","discussionApiClientHeader":"nextgen","section":"info","userAttributesApiUrl":"https://members-data-api.theguardian.com/user-attributes","videoDuration":0,"dfpHost":"pubads.g.doubleclick.net","weatherapiurl":"/weatherapi/city","sentryPublicApiKey":"344003a8d11c41d8800fbad8383fdc50","shortUrl":"https://www.theguardian.com/p/z6tbp","thumbnail":"https://i.guim.co.uk/img/media/138aadf062534a90b34ca606967b15ae7bd139a7/0_27_4031_2419/500.jpg?quality=85&auto=format&fit=max&s=f6632a700f392e7ad98bfddf7d42176a","pillar":"News","pageId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","references":[],"beaconUrl":"//phar.gu-web.net","commentable":false,"discussionD2Uid":"zHoBy6HNKsk","ophanJsUrl":"//j.ophan.co.uk/ophan.ng","contributorBio":"","keywordIds":"","contentType":"Article","isDev":false,"isHosted":false,"isAdFree":false,"stripePublicToken":"pk_live_2O6zPMHXNs2AGea4bAmq5R7Z","omnitureAccount":"guardiangu-network","locationapiurl":"/weatherapi/locations?query=","authorIds":"profile/sam-hession","isPaidContent":false,"hasYouTubeAtom":false,"externalEmbedHost":"https://embed.theguardian.com","thirdPartyAppsAccount":"guardiangu-thirdpartyapps","ajaxUrl":"https://api.nextgen.guardianapps.co.uk","byline":"Sam Hession","keywords":"","contentId":"info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data","nonKeywordTagIds":"info/series/engineering-blog,type/article,profile/sam-hession","mobileAppsAdUnitRoot":"beta-guardian-app","hasPageSkin":false,"requiresMembershipAccess":false,"seriesTags":"Engineering blog","revisionNumber":"DEV","seriesId":"info/series/engineering-blog","optimizeEpicUrl":"https://support.theguardian.com/epic/control/index.html","assetsPath":"https://assets.guim.co.uk/","mmaUrl":"https://manage.theguardian.com","isLive":false,"richLink":"","campaigns":[],"isLiveBlog":false,"pageCode":"12886126","avatarImagesUrl":"https://avatar.guim.co.uk","publication":"theguardian.com","sentryHost":"app.getsentry.com/35463","buildNumber":"DEV","userBenefitsApiUrl":"https://user-benefits.guardianapis.com/benefits/me","sharedAdTargeting":{"se":["engineering-blog"],"ct":"article","su":["0"],"edition":"uk","p":"ng","sh":"https://www.theguardian.com/p/z6tbp","co":["sam-hession"],"url":"/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},"onwardWebSocket":"ws://api.nextgen.guardianapps.co.uk/recently-published","productionOffice":"Uk","shouldHideAdverts":false,"idApiUrl":"https://idapi.theguardian.com","pbIndexSites":[{"bp":"D","id":208247},{"bp":"M","id":213519},{"bp":"T","id":215454}],"googletagJsUrl":"//securepubads.g.doubleclick.net/tag/js/gpt.js","calloutsUrl":"https://callouts.guardianapis.com/formstack-campaign/submit","isPreview":false},"guardianBaseURL":"https://www.theguardian.com","contentType":"Article","hasRelated":true,"hasStoryPackage":false,"beaconURL":"//phar.gu-web.net","isCommentable":false,"commercialProperties":{"US":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"us"},{"name":"url","value":"/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"name":"ct","value":"article"},{"name":"co","value":["sam-hession"]},{"name":"sh","value":"https://www.theguardian.com/p/z6tbp"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"AU":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"au"},{"name":"url","value":"/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"name":"ct","value":"article"},{"name":"co","value":["sam-hession"]},{"name":"sh","value":"https://www.theguardian.com/p/z6tbp"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"UK":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"uk"},{"name":"url","value":"/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"name":"ct","value":"article"},{"name":"co","value":["sam-hession"]},{"name":"sh","value":"https://www.theguardian.com/p/z6tbp"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"INT":{"adTargeting":[{"name":"su","value":["0"]},{"name":"url","value":"/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"name":"ct","value":"article"},{"name":"co","value":["sam-hession"]},{"name":"sh","value":"https://www.theguardian.com/p/z6tbp"},{"name":"edition","value":"int"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]},"EUR":{"adTargeting":[{"name":"su","value":["0"]},{"name":"url","value":"/info/2023/jun/07/roll-over-rollups-the-big-future-of-ophans-historical-data"},{"name":"ct","value":"article"},{"name":"co","value":["sam-hession"]},{"name":"sh","value":"https://www.theguardian.com/p/z6tbp"},{"name":"edition","value":"eur"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"}]}},"pageType":{"hasShowcaseMainElement":false,"isFront":false,"isLiveblog":false,"isMinuteArticle":false,"isPaidContent":false,"isPreview":false,"isSensitive":false},"trailText":"How the Guardian’s real time analytics tool pivoted from ElasticSearch Rollups to BigQuery and what we learnt along the way","nav":{"currentUrl":"/info","pillars":[{"title":"News","url":"/","longTitle":"Headlines","iconName":"home","children":[{"title":"UK","url":"/uk-news","longTitle":"UK news","children":[{"title":"UK politics","url":"/politics"},{"title":"Education","url":"/education","children":[{"title":"Schools","url":"/education/schools"},{"title":"Teachers","url":"/teacher-network"},{"title":"Universities","url":"/education/universities"},{"title":"Students","url":"/education/students"}]},{"title":"Media","url":"/media"},{"title":"Society","url":"/society"},{"title":"Law","url":"/law"},{"title":"Scotland","url":"/uk/scotland"},{"title":"Wales","url":"/uk/wales"},{"title":"Northern Ireland","url":"/uk/northernireland"}]},{"title":"US politics","url":"/us-news/us-politics"},{"title":"World","url":"/world","longTitle":"World news","children":[{"title":"Europe","url":"/world/europe-news"},{"title":"US","url":"/us-news","longTitle":"US news"},{"title":"Americas","url":"/world/americas"},{"title":"Asia","url":"/world/asia"},{"title":"Australia","url":"/australia-news","longTitle":"Australia news"},{"title":"Middle East","url":"/world/middleeast"},{"title":"Africa","url":"/world/africa"},{"title":"Inequality","url":"/inequality"},{"title":"Global development","url":"/global-development"}]},{"title":"Climate crisis","url":"/environment/climate-crisis"},{"title":"Middle East","url":"/world/middleeast"},{"title":"Ukraine","url":"/world/ukraine"},{"title":"Football","url":"/football","children":[{"title":"Live scores","url":"/football/live","longTitle":"football/live"},{"title":"Tables","url":"/football/tables","longTitle":"football/tables"},{"title":"Fixtures","url":"/football/fixtures","longTitle":"football/fixtures"},{"title":"Results","url":"/football/results","longTitle":"football/results"},{"title":"Competitions","url":"/football/competitions","longTitle":"football/competitions"},{"title":"Clubs","url":"/football/teams","longTitle":"football/teams"}]},{"title":"Newsletters","url":"/email-newsletters"},{"title":"Business","url":"/business","children":[{"title":"Economics","url":"/business/economics"},{"title":"Banking","url":"/business/banking"},{"title":"Money","url":"/money","children":[{"title":"Property","url":"/money/property"},{"title":"Pensions","url":"/money/pensions"},{"title":"Savings","url":"/money/savings"},{"title":"Borrowing","url":"/money/debt"},{"title":"Careers","url":"/money/work-and-careers"}]},{"title":"Markets","url":"/business/stock-markets"},{"title":"Project Syndicate","url":"/business/series/project-syndicate-economists"},{"title":"B2B","url":"/business-to-business"},{"title":"Retail","url":"/business/retail"}]},{"title":"Environment","url":"/environment","children":[{"title":"Climate crisis","url":"/environment/climate-crisis"},{"title":"Wildlife","url":"/environment/wildlife"},{"title":"Energy","url":"/environment/energy"},{"title":"Pollution","url":"/environment/pollution"}]},{"title":"UK politics","url":"/politics"},{"title":"Society","url":"/society"},{"title":"Science","url":"/science"},{"title":"Tech","url":"/technology"},{"title":"Global development","url":"/global-development"},{"title":"Obituaries","url":"/obituaries"}]},{"title":"Opinion","url":"/commentisfree","longTitle":"Opinion home","iconName":"home","children":[{"title":"The Guardian view","url":"/profile/editorial"},{"title":"Columnists","url":"/index/contributors"},{"title":"Cartoons","url":"/tone/cartoons"},{"title":"Opinion videos","url":"/type/video+tone/comment"},{"title":"Letters","url":"/tone/letters"}]},{"title":"Sport","url":"/sport","longTitle":"Sport home","iconName":"home","children":[{"title":"Football","url":"/football","children":[{"title":"Live scores","url":"/football/live","longTitle":"football/live"},{"title":"Tables","url":"/football/tables","longTitle":"football/tables"},{"title":"Fixtures","url":"/football/fixtures","longTitle":"football/fixtures"},{"title":"Results","url":"/football/results","longTitle":"football/results"},{"title":"Competitions","url":"/football/competitions","longTitle":"football/competitions"},{"title":"Clubs","url":"/football/teams","longTitle":"football/teams"}]},{"title":"Cricket","url":"/sport/cricket"},{"title":"Rugby union","url":"/sport/rugby-union"},{"title":"Tennis","url":"/sport/tennis"},{"title":"Cycling","url":"/sport/cycling"},{"title":"F1","url":"/sport/formulaone"},{"title":"Golf","url":"/sport/golf"},{"title":"Boxing","url":"/sport/boxing"},{"title":"Rugby league","url":"/sport/rugbyleague"},{"title":"Racing","url":"/sport/horse-racing"},{"title":"US sports","url":"/sport/us-sport"}]},{"title":"Culture","url":"/culture","longTitle":"Culture home","iconName":"home","children":[{"title":"Film","url":"/film"},{"title":"Music","url":"/music"},{"title":"TV & radio","url":"/tv-and-radio"},{"title":"Books","url":"/books"},{"title":"Art & design","url":"/artanddesign"},{"title":"Stage","url":"/stage"},{"title":"Games","url":"/games"},{"title":"Classical","url":"/music/classicalmusicandopera"}]},{"title":"Lifestyle","url":"/lifeandstyle","longTitle":"Lifestyle home","iconName":"home","children":[{"title":"The Filter","url":"/uk/thefilter"},{"title":"Fashion","url":"/fashion"},{"title":"Food","url":"/food"},{"title":"Recipes","url":"/tone/recipes"},{"title":"Travel","url":"/travel","children":[{"title":"UK","url":"/travel/uk"},{"title":"Europe","url":"/travel/europe"},{"title":"US","url":"/travel/usa"}]},{"title":"Health & fitness","url":"/lifeandstyle/health-and-wellbeing"},{"title":"Women","url":"/lifeandstyle/women"},{"title":"Men","url":"/lifeandstyle/men"},{"title":"Love & sex","url":"/lifeandstyle/love-and-sex"},{"title":"Beauty","url":"/fashion/beauty"},{"title":"Home & garden","url":"/lifeandstyle/home-and-garden"},{"title":"Money","url":"/money","children":[{"title":"Property","url":"/money/property"},{"title":"Pensions","url":"/money/pensions"},{"title":"Savings","url":"/money/savings"},{"title":"Borrowing","url":"/money/debt"},{"title":"Careers","url":"/money/work-and-careers"}]},{"title":"Cars","url":"/technology/motoring"}]}],"otherLinks":[{"title":"The Guardian app","url":"https://app.adjust.com/16xt6hai"},{"title":"Video","url":"/video"},{"title":"Podcasts","url":"/podcasts"},{"title":"Pictures","url":"/inpictures"},{"title":"Newsletters","url":"/email-newsletters"},{"title":"Today's paper","url":"/theguardian","children":[{"title":"Obituaries","url":"/obituaries"},{"title":"G2","url":"/theguardian/g2"},{"title":"Journal","url":"/theguardian/journal"},{"title":"Saturday","url":"/theguardian/saturday"}]},{"title":"Inside the Guardian","url":"https://www.theguardian.com/insidetheguardian"},{"title":"The Observer","url":"/observer","children":[{"title":"Comment","url":"/theobserver/news/comment"},{"title":"The New Review","url":"/theobserver/new-review"},{"title":"Observer Magazine","url":"/theobserver/magazine"},{"title":"Observer Food Monthly","url":"/theobserver/foodmonthly"}]},{"title":"Guardian Weekly","url":"https://www.theguardian.com/weekly?INTCMP=gdnwb_mawns_editorial_gweekly_GW_TopNav_UK"},{"title":"Crosswords","url":"/crosswords","children":[{"title":"Blog","url":"/crosswords/crossword-blog"},{"title":"Quick","url":"/crosswords/series/quick"},{"title":"Speedy","url":"/crosswords/series/speedy"},{"title":"Quick cryptic","url":"/crosswords/series/quick-cryptic"},{"title":"Everyman","url":"/crosswords/series/everyman"},{"title":"Quiptic","url":"/crosswords/series/quiptic"},{"title":"Cryptic","url":"/crosswords/series/cryptic"},{"title":"Prize","url":"/crosswords/series/prize"},{"title":"Azed","url":"/crosswords/series/azed"},{"title":"Genius","url":"/crosswords/series/genius"},{"title":"Weekend","url":"/crosswords/series/weekend-crossword"},{"title":"Special","url":"/crosswords/series/special"}]},{"title":"Wordiply","url":"https://www.wordiply.com"},{"title":"Corrections","url":"/theguardian/series/corrections-and-clarifications"}],"brandExtensions":[{"title":"Search jobs","url":"https://jobs.theguardian.com"},{"title":"Hire with Guardian Jobs","url":"https://recruiters.theguardian.com/?utm_source=gdnwb&utm_medium=navbar&utm_campaign=Guardian_Navbar_Recruiters&CMP_TU=trdmkt&CMP_BUNIT=jobs"},{"title":"Holidays","url":"https://holidays.theguardian.com?INTCMP=holidays_uk_web_newheader"},{"title":"Live events","url":"https://www.theguardian.com/guardian-live-events?INTCMP=live_uk_header_dropdown"},{"title":"About Us","url":"/about"},{"title":"Digital Archive","url":"https://theguardian.newspapers.com"},{"title":"Guardian Print Shop","url":"/artanddesign/series/gnm-print-sales"},{"title":"Patrons","url":"https://patrons.theguardian.com/?INTCMP=header_patrons"},{"title":"Guardian Licensing","url":"https://licensing.theguardian.com/"}],"readerRevenueLinks":{"header":{"contribute":"https://support.theguardian.com/contribute?INTCMP=header_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=header_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=header_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=header_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_supporter_cta%22%7D"},"footer":{"contribute":"https://support.theguardian.com/contribute?INTCMP=footer_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=footer_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=footer_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=footer_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_supporter_cta%22%7D"},"sideMenu":{"contribute":"https://support.theguardian.com/contribute?INTCMP=side_menu_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=side_menu_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=side_menu_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=mobilenav_print_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22mobilenav_print_cta%22%7D"},"ampHeader":{"contribute":"https://support.theguardian.com/contribute?INTCMP=header_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=header_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=amp_header_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22amp_header_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=header_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_supporter_cta%22%7D"},"ampFooter":{"contribute":"https://support.theguardian.com/contribute?INTCMP=amp_footer_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=amp_footer_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=footer_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=amp_footer_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_supporter_cta%22%7D"}}},"showBottomSocialButtons":true,"pageFooter":{"footerLinks":[[{"text":"About us","url":"/about","dataLinkName":"uk : footer : about us","extraClasses":""},{"text":"Help","url":"https://manage.theguardian.com/help-centre","dataLinkName":"uk : footer : tech feedback","extraClasses":"js-tech-feedback-report"},{"text":"Complaints & corrections","url":"/info/complaints-and-corrections","dataLinkName":"complaints","extraClasses":""},{"text":"SecureDrop","url":"https://www.theguardian.com/securedrop","dataLinkName":"securedrop","extraClasses":""},{"text":"Work for us","url":"https://workforus.theguardian.com","dataLinkName":"uk : footer : work for us","extraClasses":""},{"text":"Privacy policy","url":"/info/privacy","dataLinkName":"privacy","extraClasses":""},{"text":"Cookie policy","url":"/info/cookies","dataLinkName":"cookie","extraClasses":""},{"text":"Terms & conditions","url":"/help/terms-of-service","dataLinkName":"terms","extraClasses":""},{"text":"Contact us","url":"/help/contact-us","dataLinkName":"uk : footer : contact us","extraClasses":""}],[{"text":"All topics","url":"/index/subjects/a","dataLinkName":"uk : footer : all topics","extraClasses":""},{"text":"All writers","url":"/index/contributors","dataLinkName":"uk : footer : all contributors","extraClasses":""},{"text":"Modern Slavery Act","url":"https://uploads.guim.co.uk/2024/09/04/Modern_Slavery_Statement_2024_.pdf","dataLinkName":"uk : footer : modern slavery act statement","extraClasses":""},{"text":"Tax strategy","url":"https://uploads.guim.co.uk/2024/08/27/TAX_STRATEGY_FOR_THE_YEAR_ENDED_31_MARCH_2025.pdf","dataLinkName":"uk : footer : tax strategy","extraClasses":""},{"text":"Digital newspaper archive","url":"https://theguardian.newspapers.com","dataLinkName":"digital newspaper archive","extraClasses":""},{"text":"Facebook","url":"https://www.facebook.com/theguardian","dataLinkName":"uk : footer : facebook","extraClasses":""},{"text":"YouTube","url":"https://www.youtube.com/user/TheGuardian","dataLinkName":"uk : footer : youtube","extraClasses":""},{"text":"Instagram","url":"https://www.instagram.com/guardian","dataLinkName":"uk : footer : instagram","extraClasses":""},{"text":"LinkedIn","url":"https://www.linkedin.com/company/theguardian","dataLinkName":"uk : footer : linkedin","extraClasses":""},{"text":"Newsletters","url":"/email-newsletters?INTCMP=DOTCOM_FOOTER_NEWSLETTER_UK","dataLinkName":"uk : footer : newsletters","extraClasses":""}],[{"text":"Advertise with us","url":"https://advertising.theguardian.com","dataLinkName":"uk : footer : advertise with us","extraClasses":""},{"text":"Guardian Labs","url":"/guardian-labs","dataLinkName":"uk : footer : guardian labs","extraClasses":""},{"text":"Search jobs","url":"https://jobs.theguardian.com","dataLinkName":"uk : footer : jobs","extraClasses":""},{"text":"Patrons","url":"https://patrons.theguardian.com?INTCMP=footer_patrons","dataLinkName":"uk : footer : patrons","extraClasses":""}]]},"publication":"theguardian.com","shouldHideReaderRevenue":false,"slotMachineFlags":"","contributionsServiceUrl":"https://contributions.guardianapis.com","isSpecialReport":false,"showTableOfContents":false,"lang":"en","isRightToLeftLang":false}