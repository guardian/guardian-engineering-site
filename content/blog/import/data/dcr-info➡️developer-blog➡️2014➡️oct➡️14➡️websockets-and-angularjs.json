{"version":3,"headline":"Websockets and AngularJS","standfirst":"<p>Making Angular and WebSockets play nice</p>","webTitle":"Websockets and AngularJS","mainMediaElements":[],"main":"","filterKeyEvents":false,"keyEvents":[],"blocks":[{"id":"542ac67be4b0cd82a095e4e9","elements":[{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>As part of our internal CMS, we’ve been adding presence indicators to documents to stop people from treading on other people’s toes. A presence indicator is basically just a little circle with someone’s initials in it. They’re simple and visually obvious so people know when they might be about to overwrite someone else’s changes. A white circle is the current user; a purple circle is any other user. You can hover over a person’s circle to see their full name - a lot of people have the same initials at the Guardian!</p>","elementId":"2715e901-0016-4d97-a937-49a2d22f81ab"},{"displayCredit":true,"_type":"model.dotcomrendering.pageElements.ImageBlockElement","role":"inline","media":{"allImages":[{"index":0,"fields":{"height":"100","width":"1020"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png"},{"index":1,"fields":{"height":"61","width":"620"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991388/a69b99eb-c196-4a5c-b387-2efe2c4c14a9-620x61.png"},{"index":2,"fields":{"height":"53","width":"540"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991791/a6390432-6cd1-47c9-874f-50f0967283ac-540x53.png"},{"index":3,"fields":{"height":"45","width":"460"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991676/07e0071e-55a5-4c88-829c-5cab6258b36f-460x45.png"},{"index":4,"fields":{"height":"37","width":"380"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991505/a4cdd086-2581-47ae-b97c-80da2021265b-380x37.png"},{"index":5,"fields":{"height":"29","width":"300"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759992149/e7e5f3ef-43aa-4aa9-8136-7e0b4fac23e7-300x29.png"},{"index":6,"fields":{"height":"21","width":"220"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759992286/dd22a66e-187c-44ee-9be7-ad5f9efcca55-220x21.png"},{"index":7,"fields":{"height":"14","width":"140"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991920/e5591abf-fca5-4254-8754-dda86b34fd5d-140x14.png"},{"index":8,"fields":{"height":"68","width":"68"},"mediaType":"Image","mimeType":"image/png","url":"https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/10/8/1412759992026/db9cca04-0283-4adb-9e31-48209f2c3ba6-68x68.png"}]},"elementId":"885e258a-9ed1-43d9-a504-5e84a62cac90","imageSources":[{"weighting":"inline","srcSet":[{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=85&auto=format&fit=max&s=ad5e85317b369dbaae0c1f65531fc8ec","width":620},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=ae8fbd885ccf115f10b6c0b4ca93db29","width":1240},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=85&auto=format&fit=max&s=a3252519951c8fb7d3d6f160214c8f43","width":605},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=28a7dc9fff922e807b19b1a0f6e3e323","width":1210},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=85&auto=format&fit=max&s=4d09e5a3818787c2b61df9040d261d0c","width":445},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=b4692385d5d574de703e5755eb4dfa8b","width":890}]},{"weighting":"thumbnail","srcSet":[{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=140&quality=85&auto=format&fit=max&s=bfbc2e9a4ce8481fe0d1ebb4ee7e3020","width":140},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=140&quality=45&auto=format&fit=max&dpr=2&s=7e31f110ebb7783714e272a2a7810144","width":280},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=120&quality=85&auto=format&fit=max&s=31138088ec6f05b1340f33b2b5f0b080","width":120},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=120&quality=45&auto=format&fit=max&dpr=2&s=6573583f5626b1668834a2b861ab9e04","width":240}]},{"weighting":"supporting","srcSet":[{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=380&quality=85&auto=format&fit=max&s=bd1bdb2d7bf2a34c3f367a23f9381368","width":380},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=380&quality=45&auto=format&fit=max&dpr=2&s=e2e2ba52881b04d56845175c91bf4bbe","width":760},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=300&quality=85&auto=format&fit=max&s=33d5bada25d1243a96ec3230fdb1d307","width":300},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=300&quality=45&auto=format&fit=max&dpr=2&s=7a9396f6dda85763f9739ba61b9bb266","width":600},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=85&auto=format&fit=max&s=ad5e85317b369dbaae0c1f65531fc8ec","width":620},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=ae8fbd885ccf115f10b6c0b4ca93db29","width":1240},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=85&auto=format&fit=max&s=a3252519951c8fb7d3d6f160214c8f43","width":605},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=28a7dc9fff922e807b19b1a0f6e3e323","width":1210},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=85&auto=format&fit=max&s=4d09e5a3818787c2b61df9040d261d0c","width":445},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=b4692385d5d574de703e5755eb4dfa8b","width":890}]},{"weighting":"showcase","srcSet":[{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=860&quality=85&auto=format&fit=max&s=7258b003a9573dd051a4d32e86a2fc92","width":860},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=860&quality=45&auto=format&fit=max&dpr=2&s=b6fd1d1301d859ec74be93455ea36928","width":1720},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=780&quality=85&auto=format&fit=max&s=8406d3d1b91c1952326cc08060d3f3e5","width":780},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=780&quality=45&auto=format&fit=max&dpr=2&s=447ebafec03fdfda18b6797a5c71d890","width":1560},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=85&auto=format&fit=max&s=ad5e85317b369dbaae0c1f65531fc8ec","width":620},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=ae8fbd885ccf115f10b6c0b4ca93db29","width":1240},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=85&auto=format&fit=max&s=a3252519951c8fb7d3d6f160214c8f43","width":605},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=28a7dc9fff922e807b19b1a0f6e3e323","width":1210},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=85&auto=format&fit=max&s=4d09e5a3818787c2b61df9040d261d0c","width":445},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=b4692385d5d574de703e5755eb4dfa8b","width":890}]},{"weighting":"halfwidth","srcSet":[{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=85&auto=format&fit=max&s=ad5e85317b369dbaae0c1f65531fc8ec","width":620},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=620&quality=45&auto=format&fit=max&dpr=2&s=ae8fbd885ccf115f10b6c0b4ca93db29","width":1240},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=85&auto=format&fit=max&s=a3252519951c8fb7d3d6f160214c8f43","width":605},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=605&quality=45&auto=format&fit=max&dpr=2&s=28a7dc9fff922e807b19b1a0f6e3e323","width":1210},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=85&auto=format&fit=max&s=4d09e5a3818787c2b61df9040d261d0c","width":445},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=445&quality=45&auto=format&fit=max&dpr=2&s=b4692385d5d574de703e5755eb4dfa8b","width":890}]},{"weighting":"immersive","srcSet":[{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1900&quality=85&auto=format&fit=max&s=95e0beb143f9868bedb84219e18bdc05","width":1900},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1900&quality=45&auto=format&fit=max&dpr=2&s=35aeba43ad866bdb188ee281df603e8d","width":3800},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1300&quality=85&auto=format&fit=max&s=6fc32e0347042a79524c5d72babe8c4b","width":1300},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1300&quality=45&auto=format&fit=max&dpr=2&s=9f661d48966080969d51602c89571ee1","width":2600},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1140&quality=85&auto=format&fit=max&s=9239d65247a2116a7f6ee70b43b68f93","width":1140},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1140&quality=45&auto=format&fit=max&dpr=2&s=4aeeb1765e199536a71d838d6e46cd02","width":2280},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=980&quality=85&auto=format&fit=max&s=4fcd511be6558d458fa548ebf241649d","width":980},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=980&quality=45&auto=format&fit=max&dpr=2&s=49cb41ff362c258157a6729b45e912f6","width":1960},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=740&quality=85&auto=format&fit=max&s=2bbada8f0e196d20b492fc68938f59ce","width":740},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=740&quality=45&auto=format&fit=max&dpr=2&s=eaa66436e50d644f38018e9328923a48","width":1480},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=660&quality=85&auto=format&fit=max&s=6457e56ebf6942c9b44762fc2cae3b65","width":660},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=660&quality=45&auto=format&fit=max&dpr=2&s=7d94d14e144a43d4cc79f3fc15885191","width":1320},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=480&quality=85&auto=format&fit=max&s=32653d0dbed8d7945ddf857a57bf10e5","width":480},{"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=480&quality=45&auto=format&fit=max&dpr=2&s=0f4c12e1d0d343436b1917e15660e83f","width":960}]}],"data":{"alt":"Presence indicators","caption":"Presence indicators in use in the Guardian’s internal CMS.","credit":"Photograph: The Guardian"}},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>When a user arrives in the document, a request is sent to the server to inform other users of the new arrival. Every other person in the document is then sent an event, informing them of the change, and their UI is updated accordingly (think Google Docs but different). This whole process doesn’t really fit within the Angular $digest cycle and REST backend style of development.</p>","elementId":"79a17191-5b1d-4212-a5e1-35b9a77289b9"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>AngularJS works particularly nicely with a REST API. While it’s meant to be mostly indifferent, it works particularly well when backed by such an API. A quick glance at the <a href=\"https://docs.angularjs.org/tutorial/step_11\">docs</a> and you can see it’s meant to be. This is great. But, doesn’t quite offer the right level of realtime control for our presence indicators.</p>","elementId":"a98cadcb-f397-49cb-b6fc-63ef4eafc7df"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>The easiest way to implement this was to use a WebSocket. We tried using Server Sent events but this required the server to poll the client every few seconds to see if anything had changed. A fully duplex WebSocket means the client can update the server and vice verse in real time.</p>","elementId":"63a5d38f-98b4-4506-b0dd-27f8390f1ec4"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>As it stands, there is no Angular-sanctioned plugin for easy WebSocket integration. There are plenty of other plugins around but Angular makes it so easy to do this sort of thing, we decided to roll our own. To do this, I first separated out the connection logic from the actual processing logic. No one wants to have to think about the status of a connection while managing endless callbacks. Instead the connection service exposed a single function to register callbacks (shown below).</p>","elementId":"1a594e43-e1a5-4c9c-8aa9-c72120889e9c"},{"_type":"model.dotcomrendering.pageElements.CodeBlockElement","isMandatory":false,"language":"javascript","elementId":"dc6ebf41-9b6e-4f83-8dd4-8c16db551a6b","html":"function setupMessaging(fn) {\n    connection.onmessage = function (event) {\n    var msg = JSON.parse(event.data);\n    fn(msg);\n  };\n}"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Using this directly in controllers would have inevitably led to headaches. Which controller registered which callback? Why do the controllers need to interact with what is essentially the raw transport layer? And on and on ... So another service holds the enviable role of interacting with the connection.</p>","elementId":"8e3e0ff8-8a07-4ead-8a51-7e4fb29b416a"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>This service (let’s call it <em>indicator-service</em>), exposes a simple function register which controllers can use to register on a socket event. This is shown here:</p>","elementId":"ddd3f88e-3e72-4e26-92cc-f2bc7ae1ccf7"},{"_type":"model.dotcomrendering.pageElements.CodeBlockElement","isMandatory":false,"language":"javascript","elementId":"c4835b3f-bb86-4706-85eb-d77e808ae072","html":"function register(action, fn) {\n    registeredListeners.push(action);\n    $rootScope.$on(action, function (event, data) {\n        $rootScope.$apply(function () {\n            fn(data);\n        });\n    });\n}"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>This code binds a function to an event emitted by the $rootScope. The catch is that only the indicator-service emits these events. So, in a <a href=\"http://postmoderntherapies.com/word.html\">paradoxical language-game</a>, it only inhabits its own universe. This solipsism keeps our scope listeners clean and contained. The other alternative to this is to bind the listeners in the controllers and then broadcast the event down to the child controllers - which would have been messy.</p>","elementId":"fc19761d-ad60-43fe-acc8-4410b5ab3ca8"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>Savvy readers will have noticed that the above could end up with multiple listeners being bound to a single event. This would result in the handler for a connection opening, for example, being executed twice. Thus, the final function for easy WebSocket handling is shown below:</p>","elementId":"ee09bf19-74d5-403a-8062-18fd0d582cf6"},{"_type":"model.dotcomrendering.pageElements.CodeBlockElement","isMandatory":false,"language":"javascript","elementId":"a0e31e3f-f5cd-4d36-942c-3dbddd88f1da","html":"function closeConnection() {\n   destroyListeners();\n   connection.endConnection();\n}\n\nfunction destroyListeners() {\n    registeredListeners.forEach(function (value) {\n        $rootScope.$$listeners[value] = [];\n    });\n    registeredListeners = [];\n}"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>This performs a final cleanup of our event handlers before closing the WebSocket. It is called when the connection is closed manually or when an error is thrown.</p>","elementId":"85b14c5f-ffdc-4c18-b949-5b1b2ec69a11"},{"_type":"model.dotcomrendering.pageElements.TextBlockElement","html":"<p>I hope I’ve demonstrated one way to handle WebSockets cleanly in Angular. There are, of course, <a href=\"https://github.com/gdi2290/angular-websocket\">many</a> <a href=\"http://blog.pusher.com/making-angular-js-realtime-with-pusher/\">other</a> <a href=\"http://clintberry.com/2013/angular-js-websocket-service/\">ways</a> to do it.</p>","elementId":"75bfda16-0a2d-459a-95ac-f0c24fa19e50"}],"attributes":{"pinned":false,"keyEvent":false,"summary":false},"blockCreatedOn":1413280326000,"blockCreatedOnDisplay":"10.52 BST","blockLastUpdated":1619183811000,"blockLastUpdatedDisplay":"14.16 BST","blockFirstPublished":1413280326000,"blockFirstPublishedDisplay":"10.52 BST","blockFirstPublishedDisplayNoTimezone":"10.52","contributors":[],"primaryDateLine":"Tue 14 Oct 2014 10.52 BST","secondaryDateLine":"Last modified on Fri 23 Apr 2021 14.16 BST"}],"author":{},"webPublicationDate":"2014-10-14T09:52:06.000Z","webPublicationDateDeprecated":"2014-10-14T09:52:06.000Z","webPublicationDateDisplay":"Tue 14 Oct 2014 10.52 BST","webPublicationSecondaryDateDisplay":"Last modified on Fri 23 Apr 2021 14.16 BST","editionLongForm":"UK edition","editionId":"UK","pageId":"info/developer-blog/2014/oct/14/websockets-and-angularjs","canonicalUrl":"https://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs","format":{"design":"ArticleDesign","theme":"NewsPillar","display":"StandardDisplay"},"designType":"Article","tags":[{"id":"info/series/engineering-blog","type":"Series","title":"Engineering blog"},{"id":"technology/programming","type":"Keyword","title":"Programming"},{"id":"technology/computing","type":"Keyword","title":"Computing"},{"id":"type/article","type":"Type","title":"Article"}],"pillar":"news","isLegacyInteractive":false,"isImmersive":false,"sectionLabel":"Programming","sectionUrl":"technology/programming","sectionName":"info","subMetaSectionLinks":[{"url":"/technology/programming","title":"Programming"},{"url":"/info/series/engineering-blog","title":"Engineering blog"}],"subMetaKeywordLinks":[{"url":"/technology/computing","title":"Computing"}],"shouldHideAds":false,"isAdFreeUser":false,"webURL":"https://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs","linkedData":[{"@type":"NewsArticle","@context":"https://schema.org","@id":"https://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs","publisher":{"@type":"Organization","@context":"https://schema.org","@id":"https://www.theguardian.com#publisher","name":"The Guardian","url":"https://www.theguardian.com/","logo":{"@type":"ImageObject","url":"https://uploads.guim.co.uk/2018/01/31/TheGuardian_AMP.png","width":190,"height":60},"sameAs":["https://www.facebook.com/theguardian","https://twitter.com/guardian","https://www.youtube.com/user/TheGuardian"]},"isAccessibleForFree":true,"isPartOf":{"@type":["CreativeWork","Product"],"name":"The Guardian","productID":"theguardian.com:basic"},"image":["https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png","https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png","https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png","https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png"],"author":[{"@type":"Person","name":"Guardian staff reporter"}],"datePublished":"2014-10-14T09:52:06.000Z","headline":"Websockets and AngularJS","dateModified":"2021-04-23T13:16:51.000Z","mainEntityOfPage":"https://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs"},{"@type":"WebPage","@context":"https://schema.org","@id":"https://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs","potentialAction":{"@type":"ViewAction","target":"android-app://com.guardian/https/www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs"}}],"openGraphData":{"og:url":"http://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs","article:author":"Guardian Staff","og:description":"Making Angular and Websockets play nice","og:image:width":"1200","og:image":"https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png","al:ios:url":"gnmguardian://info/developer-blog/2014/oct/14/websockets-and-angularjs?contenttype=Article&source=applinks","article:publisher":"https://www.facebook.com/theguardian","og:title":"Websockets and AngularJS","fb:app_id":"180444840287","article:modified_time":"2021-04-23T13:16:51.000Z","og:type":"article","al:ios:app_store_id":"409128287","article:section":"Info","article:published_time":"2014-10-14T09:52:06.000Z","article:tag":"Programming,Computing","al:ios:app_name":"The Guardian","og:site_name":"the Guardian"},"twitterData":{"twitter:app:id:iphone":"409128287","twitter:app:name:googleplay":"The Guardian","twitter:app:name:ipad":"The Guardian","twitter:card":"summary_large_image","twitter:app:name:iphone":"The Guardian","twitter:app:id:ipad":"409128287","twitter:app:id:googleplay":"com.guardian","twitter:app:url:googleplay":"guardian://www.theguardian.com/info/developer-blog/2014/oct/14/websockets-and-angularjs","twitter:app:url:iphone":"gnmguardian://info/developer-blog/2014/oct/14/websockets-and-angularjs?contenttype=Article&source=twitter","twitter:image":"https://assets.guim.co.uk/images/eada8aa27c12fe2d5afa3a89d3fbae0d/fallback-logo.png","twitter:site":"@guardian","twitter:app:url:ipad":"gnmguardian://info/developer-blog/2014/oct/14/websockets-and-angularjs?contenttype=Article&source=twitter"},"config":{"switches":{"lightbox":true,"abPrebidKeywords":true,"personaliseSignInGateAfterCheckout":true,"abSignInGateMainVariant":true,"prebidAppnexusUkRow":true,"prebidMagnite":true,"commercialMetrics":true,"prebidTrustx":true,"scAdFreeBanner":false,"adaptiveSite":true,"prebidPermutiveAudience":true,"compareVariantDecision":false,"enableSentryReporting":true,"lazyLoadContainers":true,"ampArticleSwitch":false,"remarketing":true,"articleEndSlot":true,"keyEventsCarousel":true,"registerWithPhone":false,"darkModeWeb":true,"targeting":true,"remoteHeader":true,"slotBodyEnd":true,"ampPrebidOzone":false,"extendedMostPopularFronts":true,"emailInlineInFooter":true,"showNewPrivacyWordingOnEmailSignupEmbeds":true,"prebidAnalytics":true,"extendedMostPopular":true,"ampContentAbTesting":false,"prebidCriteo":true,"okta":true,"imrWorldwide":true,"acast":true,"twitterUwt":true,"abAuxiaSignInGate":false,"abDeferPermutiveLoad":true,"prebidAppnexusInvcode":true,"ampPrebidPubmatic":false,"a9HeaderBidding":true,"prebidAppnexus":true,"enableDiscussionSwitch":true,"prebidXaxis":true,"stickyVideos":true,"interactiveFullHeaderSwitch":true,"discussionAllPageSize":true,"prebidUserSync":true,"audioOnwardJourneySwitch":true,"abMovePermutiveSegmentation":false,"brazeTaylorReport":false,"externalVideoEmbeds":true,"abTheTradeDesk":true,"callouts":true,"sentinelLogger":true,"geoMostPopular":true,"weAreHiring":false,"relatedContent":true,"thirdPartyEmbedTracking":true,"prebidOzone":true,"ampLiveblogSwitch":false,"ampAmazon":false,"prebidAdYouLike":true,"mostViewedFronts":true,"optOutAdvertising":true,"abSignInGateMainControl":true,"googleSearch":true,"abOptOutFrequencyCap":true,"brazeSwitch":true,"prebidKargo":true,"consentManagement":true,"idProfileNavigation":true,"confiantAdVerification":true,"discussionAllowAnonymousRecommendsSwitch":false,"dcrCrosswords":true,"absoluteServerTimes":false,"permutive":true,"comscore":true,"ampPrebidCriteo":false,"prebidTheTradeDesk":true,"loopVideoTest":false,"newsletterOnwards":false,"youtubeIma":true,"webFonts":true,"liveBlogTopSponsorship":true,"abAdBlockAsk":false,"ophan":true,"crosswordSvgThumbnails":true,"prebidTriplelift":true,"prebidPubmatic":true,"serverShareCounts":false,"autoRefresh":true,"enhanceTweets":true,"prebidIndexExchange":true,"prebidOpenx":true,"prebidHeaderBidding":true,"idCookieRefresh":true,"discussionPageSize":true,"smartAppBanner":false,"historyTags":true,"brazeContentCards":true,"remoteBanner":true,"emailSignupRecaptcha":true,"prebidSmart":true,"shouldLoadGoogletag":true,"inizio":true,"europeBetaFront":true},"abTests":{},"googletagUrl":"//securepubads.g.doubleclick.net/tag/js/gpt.js","stage":"PROD","frontendAssetsFullURL":"https://assets.guim.co.uk/","ampIframeUrl":"https://assets.guim.co.uk/data/vendor/2533d5cb94302889e6a8f1b24b5329e7/amp-iframe.html","tones":"","facebookIaAdUnitRoot":"facebook-instant-articles","avatarApiUrl":"https://avatar.theguardian.com","isSplash":false,"isColumn":false,"membershipUrl":"https://membership.theguardian.com","headline":"Websockets and AngularJS","isImmersive":false,"author":"","ipsosTag":"guardian","isProd":true,"series":"Engineering blog","toneIds":"","membershipAccess":"","allowUserGeneratedContent":false,"commissioningDesks":"","webPublicationDate":1413280326000,"forecastsapiurl":"/weatherapi/forecast","supportUrl":"https://support.theguardian.com","isNumberedList":false,"commercialBundleUrl":"https://assets.guim.co.uk/commercial/47e59a6f2531251d895a/graun.standalone.commercial.js","idOAuthUrl":"https://oauth.theguardian.com","webTitle":"Websockets and AngularJS","isPhotoEssay":false,"idWebAppUrl":"https://oauth.theguardian.com","a9PublisherId":"3722","isFront":false,"inBodyInternalLinkCount":0,"googleSearchUrl":"//www.google.co.uk/cse/cse.js","inBodyExternalLinkCount":5,"showRelatedContent":true,"lightboxImages":{"id":"info/developer-blog/2014/oct/14/websockets-and-angularjs","headline":"Websockets and AngularJS","shouldHideAdverts":false,"standfirst":"<p>Making Angular and WebSockets play nice</p>","images":[{"caption":"Presence indicators in use in the Guardian’s internal CMS.","credit":"Photograph: The Guardian","displayCredit":true,"src":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=700&quality=85&auto=format&fit=max&s=0b1ccca975c1ff0860e8743db4b9efaf","srcsets":"https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1920&quality=85&auto=format&fit=max&s=ae93398f759111f3950f6344f62d4f0f 1920w, https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1225&quality=85&auto=format&fit=max&s=b771103307df042d71202509003abe3d 1225w, https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=1065&quality=85&auto=format&fit=max&s=b8cbb8b42115815ca1230e756b07d3a6 1065w, https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=965&quality=85&auto=format&fit=max&s=89306f4fecac90442513b19eeeb5c852 965w, https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=725&quality=85&auto=format&fit=max&s=044a4930a35ade56860d12c5081ddc7d 725w, https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=645&quality=85&auto=format&fit=max&s=a4388cc7af70dfae2f8e31346901f526 645w, https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2014/10/8/1412759991187/e50076f4-1a16-419f-8746-81500a7b9e07-1020x100.png?width=465&quality=85&auto=format&fit=max&s=3f2cf74ada861df2f2f34f85126fac2b 465w","sizes":"(min-width: 1300px) 1920px, (min-width: 1140px) 1225px, (min-width: 980px) 1065px, (min-width: 740px) 965px, (min-width: 660px) 725px, (min-width: 480px) 645px, 465px","ratio":10.2,"role":"None","parentContentId":"info/developer-blog/2014/oct/14/websockets-and-angularjs","id":"info/developer-blog/2014/oct/14/websockets-and-angularjs"}]},"googleSearchId":"007466294097402385199:m2ealvuxh1i","shouldHideReaderRevenue":false,"idUrl":"https://profile.theguardian.com","hasSurveyAd":false,"omnitureAmpAccount":"guardiangu-thirdpartyapps","dfpAdUnitRoot":"theguardian.com","host":"https://www.theguardian.com","blogIds":"","sectionName":"Info","hasMultipleVideosInPage":false,"hasShowcaseMainElement":false,"googleRecaptchaSiteKey":"6LdzlmsdAAAAALFH63cBVagSFPuuHXQ9OfpIDdMc","fbAppId":"180444840287","isContent":true,"shortUrlId":"/p/423vj","dfpAccountId":"59666047","plistaPublicApiKey":"462925f4f131001fd974bebe","wordCount":691,"hasLiveBlogTopAd":false,"dcrSentryDsn":"https://1937ab71c8804b2b8438178dfdd6468f@sentry.io/1377847","cardStyle":"news","adUnit":"/59666047/theguardian.com/info/article/ng","discussionApiUrl":"https://discussion.theguardian.com/discussion-api","isSensitive":false,"ophanEmbedJsUrl":"//j.ophan.co.uk/ophan.embed","edition":"UK","brazeApiKey":"7f28c639-8bda-48ff-a3f6-24345abfc07c","blogs":"","discussionApiClientHeader":"nextgen","section":"info","userAttributesApiUrl":"https://members-data-api.theguardian.com/user-attributes","videoDuration":0,"dfpHost":"pubads.g.doubleclick.net","weatherapiurl":"/weatherapi/city","sentryPublicApiKey":"344003a8d11c41d8800fbad8383fdc50","shortUrl":"https://www.theguardian.com/p/423vj","thumbnail":false,"pillar":"News","pageId":"info/developer-blog/2014/oct/14/websockets-and-angularjs","references":[],"beaconUrl":"//phar.gu-web.net","commentable":true,"discussionD2Uid":"zHoBy6HNKsk","ophanJsUrl":"//j.ophan.co.uk/ophan.ng","contributorBio":"","keywordIds":"technology/programming,technology/computing","contentType":"Article","isDev":false,"isHosted":false,"isAdFree":false,"stripePublicToken":"pk_live_2O6zPMHXNs2AGea4bAmq5R7Z","omnitureAccount":"guardiangu-network","locationapiurl":"/weatherapi/locations?query=","authorIds":"","isPaidContent":false,"hasYouTubeAtom":false,"externalEmbedHost":"https://embed.theguardian.com","thirdPartyAppsAccount":"guardiangu-thirdpartyapps","ajaxUrl":"https://api.nextgen.guardianapps.co.uk","byline":"","keywords":"Programming,Computing","contentId":"info/developer-blog/2014/oct/14/websockets-and-angularjs","nonKeywordTagIds":"info/series/engineering-blog,type/article","mobileAppsAdUnitRoot":"beta-guardian-app","hasPageSkin":false,"requiresMembershipAccess":false,"seriesTags":"Engineering blog","revisionNumber":"DEV","seriesId":"info/series/engineering-blog","optimizeEpicUrl":"https://support.theguardian.com/epic/control/index.html","assetsPath":"https://assets.guim.co.uk/","mmaUrl":"https://manage.theguardian.com","isLive":false,"richLink":"","campaigns":[],"isLiveBlog":false,"pageCode":"2167336","avatarImagesUrl":"https://avatar.guim.co.uk","publication":"theguardian.com","sentryHost":"app.getsentry.com/35463","buildNumber":"DEV","userBenefitsApiUrl":"https://user-benefits.guardianapis.com/benefits/me","sharedAdTargeting":{"se":["engineering-blog"],"ct":"article","url":"/info/developer-blog/2014/oct/14/websockets-and-angularjs","su":["0"],"edition":"uk","p":"ng","k":["programming","computing"],"sh":"https://www.theguardian.com/p/423vj"},"onwardWebSocket":"ws://api.nextgen.guardianapps.co.uk/recently-published","productionOffice":"Uk","shouldHideAdverts":false,"idApiUrl":"https://idapi.theguardian.com","pbIndexSites":[{"bp":"D","id":208247},{"bp":"M","id":213519},{"bp":"T","id":215454}],"googletagJsUrl":"//securepubads.g.doubleclick.net/tag/js/gpt.js","calloutsUrl":"https://callouts.guardianapis.com/formstack-campaign/submit","isPreview":false},"guardianBaseURL":"https://www.theguardian.com","contentType":"Article","hasRelated":true,"hasStoryPackage":false,"beaconURL":"//phar.gu-web.net","isCommentable":true,"commercialProperties":{"US":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"us"},{"name":"k","value":["programming","computing"]},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"},{"name":"url","value":"/info/developer-blog/2014/oct/14/websockets-and-angularjs"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/423vj"}]},"AU":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"au"},{"name":"k","value":["programming","computing"]},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"},{"name":"url","value":"/info/developer-blog/2014/oct/14/websockets-and-angularjs"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/423vj"}]},"UK":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"uk"},{"name":"k","value":["programming","computing"]},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"},{"name":"url","value":"/info/developer-blog/2014/oct/14/websockets-and-angularjs"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/423vj"}]},"INT":{"adTargeting":[{"name":"su","value":["0"]},{"name":"k","value":["programming","computing"]},{"name":"edition","value":"int"},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"},{"name":"url","value":"/info/developer-blog/2014/oct/14/websockets-and-angularjs"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/423vj"}]},"EUR":{"adTargeting":[{"name":"su","value":["0"]},{"name":"edition","value":"eur"},{"name":"k","value":["programming","computing"]},{"name":"se","value":["engineering-blog"]},{"name":"p","value":"ng"},{"name":"url","value":"/info/developer-blog/2014/oct/14/websockets-and-angularjs"},{"name":"ct","value":"article"},{"name":"sh","value":"https://www.theguardian.com/p/423vj"}]}},"pageType":{"hasShowcaseMainElement":false,"isFront":false,"isLiveblog":false,"isMinuteArticle":false,"isPaidContent":false,"isPreview":false,"isSensitive":false},"trailText":"Making Angular and Websockets play nice","nav":{"currentUrl":"/info","pillars":[{"title":"News","url":"/","longTitle":"Headlines","iconName":"home","children":[{"title":"UK","url":"/uk-news","longTitle":"UK news","children":[{"title":"UK politics","url":"/politics"},{"title":"Education","url":"/education","children":[{"title":"Schools","url":"/education/schools"},{"title":"Teachers","url":"/teacher-network"},{"title":"Universities","url":"/education/universities"},{"title":"Students","url":"/education/students"}]},{"title":"Media","url":"/media"},{"title":"Society","url":"/society"},{"title":"Law","url":"/law"},{"title":"Scotland","url":"/uk/scotland"},{"title":"Wales","url":"/uk/wales"},{"title":"Northern Ireland","url":"/uk/northernireland"}]},{"title":"US politics","url":"/us-news/us-politics"},{"title":"World","url":"/world","longTitle":"World news","children":[{"title":"Europe","url":"/world/europe-news"},{"title":"US","url":"/us-news","longTitle":"US news"},{"title":"Americas","url":"/world/americas"},{"title":"Asia","url":"/world/asia"},{"title":"Australia","url":"/australia-news","longTitle":"Australia news"},{"title":"Middle East","url":"/world/middleeast"},{"title":"Africa","url":"/world/africa"},{"title":"Inequality","url":"/inequality"},{"title":"Global development","url":"/global-development"}]},{"title":"Climate crisis","url":"/environment/climate-crisis"},{"title":"Middle East","url":"/world/middleeast"},{"title":"Ukraine","url":"/world/ukraine"},{"title":"Football","url":"/football","children":[{"title":"Live scores","url":"/football/live","longTitle":"football/live"},{"title":"Tables","url":"/football/tables","longTitle":"football/tables"},{"title":"Fixtures","url":"/football/fixtures","longTitle":"football/fixtures"},{"title":"Results","url":"/football/results","longTitle":"football/results"},{"title":"Competitions","url":"/football/competitions","longTitle":"football/competitions"},{"title":"Clubs","url":"/football/teams","longTitle":"football/teams"}]},{"title":"Newsletters","url":"/email-newsletters"},{"title":"Business","url":"/business","children":[{"title":"Economics","url":"/business/economics"},{"title":"Banking","url":"/business/banking"},{"title":"Money","url":"/money","children":[{"title":"Property","url":"/money/property"},{"title":"Pensions","url":"/money/pensions"},{"title":"Savings","url":"/money/savings"},{"title":"Borrowing","url":"/money/debt"},{"title":"Careers","url":"/money/work-and-careers"}]},{"title":"Markets","url":"/business/stock-markets"},{"title":"Project Syndicate","url":"/business/series/project-syndicate-economists"},{"title":"B2B","url":"/business-to-business"},{"title":"Retail","url":"/business/retail"}]},{"title":"Environment","url":"/environment","children":[{"title":"Climate crisis","url":"/environment/climate-crisis"},{"title":"Wildlife","url":"/environment/wildlife"},{"title":"Energy","url":"/environment/energy"},{"title":"Pollution","url":"/environment/pollution"}]},{"title":"UK politics","url":"/politics"},{"title":"Society","url":"/society"},{"title":"Science","url":"/science"},{"title":"Tech","url":"/technology"},{"title":"Global development","url":"/global-development"},{"title":"Obituaries","url":"/obituaries"}]},{"title":"Opinion","url":"/commentisfree","longTitle":"Opinion home","iconName":"home","children":[{"title":"The Guardian view","url":"/profile/editorial"},{"title":"Columnists","url":"/index/contributors"},{"title":"Cartoons","url":"/tone/cartoons"},{"title":"Opinion videos","url":"/type/video+tone/comment"},{"title":"Letters","url":"/tone/letters"}]},{"title":"Sport","url":"/sport","longTitle":"Sport home","iconName":"home","children":[{"title":"Football","url":"/football","children":[{"title":"Live scores","url":"/football/live","longTitle":"football/live"},{"title":"Tables","url":"/football/tables","longTitle":"football/tables"},{"title":"Fixtures","url":"/football/fixtures","longTitle":"football/fixtures"},{"title":"Results","url":"/football/results","longTitle":"football/results"},{"title":"Competitions","url":"/football/competitions","longTitle":"football/competitions"},{"title":"Clubs","url":"/football/teams","longTitle":"football/teams"}]},{"title":"Cricket","url":"/sport/cricket"},{"title":"Rugby union","url":"/sport/rugby-union"},{"title":"Tennis","url":"/sport/tennis"},{"title":"Cycling","url":"/sport/cycling"},{"title":"F1","url":"/sport/formulaone"},{"title":"Golf","url":"/sport/golf"},{"title":"Boxing","url":"/sport/boxing"},{"title":"Rugby league","url":"/sport/rugbyleague"},{"title":"Racing","url":"/sport/horse-racing"},{"title":"US sports","url":"/sport/us-sport"}]},{"title":"Culture","url":"/culture","longTitle":"Culture home","iconName":"home","children":[{"title":"Film","url":"/film"},{"title":"Music","url":"/music"},{"title":"TV & radio","url":"/tv-and-radio"},{"title":"Books","url":"/books"},{"title":"Art & design","url":"/artanddesign"},{"title":"Stage","url":"/stage"},{"title":"Games","url":"/games"},{"title":"Classical","url":"/music/classicalmusicandopera"}]},{"title":"Lifestyle","url":"/lifeandstyle","longTitle":"Lifestyle home","iconName":"home","children":[{"title":"The Filter","url":"/uk/thefilter"},{"title":"Fashion","url":"/fashion"},{"title":"Food","url":"/food"},{"title":"Recipes","url":"/tone/recipes"},{"title":"Travel","url":"/travel","children":[{"title":"UK","url":"/travel/uk"},{"title":"Europe","url":"/travel/europe"},{"title":"US","url":"/travel/usa"}]},{"title":"Health & fitness","url":"/lifeandstyle/health-and-wellbeing"},{"title":"Women","url":"/lifeandstyle/women"},{"title":"Men","url":"/lifeandstyle/men"},{"title":"Love & sex","url":"/lifeandstyle/love-and-sex"},{"title":"Beauty","url":"/fashion/beauty"},{"title":"Home & garden","url":"/lifeandstyle/home-and-garden"},{"title":"Money","url":"/money","children":[{"title":"Property","url":"/money/property"},{"title":"Pensions","url":"/money/pensions"},{"title":"Savings","url":"/money/savings"},{"title":"Borrowing","url":"/money/debt"},{"title":"Careers","url":"/money/work-and-careers"}]},{"title":"Cars","url":"/technology/motoring"}]}],"otherLinks":[{"title":"The Guardian app","url":"https://app.adjust.com/16xt6hai"},{"title":"Video","url":"/video"},{"title":"Podcasts","url":"/podcasts"},{"title":"Pictures","url":"/inpictures"},{"title":"Newsletters","url":"/email-newsletters"},{"title":"Today's paper","url":"/theguardian","children":[{"title":"Obituaries","url":"/obituaries"},{"title":"G2","url":"/theguardian/g2"},{"title":"Journal","url":"/theguardian/journal"},{"title":"Saturday","url":"/theguardian/saturday"}]},{"title":"Inside the Guardian","url":"https://www.theguardian.com/insidetheguardian"},{"title":"The Observer","url":"/observer","children":[{"title":"Comment","url":"/theobserver/news/comment"},{"title":"The New Review","url":"/theobserver/new-review"},{"title":"Observer Magazine","url":"/theobserver/magazine"},{"title":"Observer Food Monthly","url":"/theobserver/foodmonthly"}]},{"title":"Guardian Weekly","url":"https://www.theguardian.com/weekly?INTCMP=gdnwb_mawns_editorial_gweekly_GW_TopNav_UK"},{"title":"Crosswords","url":"/crosswords","children":[{"title":"Blog","url":"/crosswords/crossword-blog"},{"title":"Quick","url":"/crosswords/series/quick"},{"title":"Speedy","url":"/crosswords/series/speedy"},{"title":"Quick cryptic","url":"/crosswords/series/quick-cryptic"},{"title":"Everyman","url":"/crosswords/series/everyman"},{"title":"Quiptic","url":"/crosswords/series/quiptic"},{"title":"Cryptic","url":"/crosswords/series/cryptic"},{"title":"Prize","url":"/crosswords/series/prize"},{"title":"Azed","url":"/crosswords/series/azed"},{"title":"Genius","url":"/crosswords/series/genius"},{"title":"Weekend","url":"/crosswords/series/weekend-crossword"},{"title":"Special","url":"/crosswords/series/special"}]},{"title":"Wordiply","url":"https://www.wordiply.com"},{"title":"Corrections","url":"/theguardian/series/corrections-and-clarifications"}],"brandExtensions":[{"title":"Search jobs","url":"https://jobs.theguardian.com"},{"title":"Hire with Guardian Jobs","url":"https://recruiters.theguardian.com/?utm_source=gdnwb&utm_medium=navbar&utm_campaign=Guardian_Navbar_Recruiters&CMP_TU=trdmkt&CMP_BUNIT=jobs"},{"title":"Holidays","url":"https://holidays.theguardian.com?INTCMP=holidays_uk_web_newheader"},{"title":"Live events","url":"https://www.theguardian.com/guardian-live-events?INTCMP=live_uk_header_dropdown"},{"title":"About Us","url":"/about"},{"title":"Digital Archive","url":"https://theguardian.newspapers.com"},{"title":"Guardian Print Shop","url":"/artanddesign/series/gnm-print-sales"},{"title":"Patrons","url":"https://patrons.theguardian.com/?INTCMP=header_patrons"},{"title":"Guardian Licensing","url":"https://licensing.theguardian.com/"}],"readerRevenueLinks":{"header":{"contribute":"https://support.theguardian.com/contribute?INTCMP=header_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=header_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=header_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=header_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_supporter_cta%22%7D"},"footer":{"contribute":"https://support.theguardian.com/contribute?INTCMP=footer_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=footer_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=footer_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=footer_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_supporter_cta%22%7D"},"sideMenu":{"contribute":"https://support.theguardian.com/contribute?INTCMP=side_menu_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=side_menu_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=side_menu_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22side_menu_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=mobilenav_print_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22mobilenav_print_cta%22%7D"},"ampHeader":{"contribute":"https://support.theguardian.com/contribute?INTCMP=header_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=header_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=amp_header_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22amp_header_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=header_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_HEADER%22,%22componentId%22:%22header_supporter_cta%22%7D"},"ampFooter":{"contribute":"https://support.theguardian.com/contribute?INTCMP=amp_footer_support_contribute&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_support_contribute%22%7D","subscribe":"https://support.theguardian.com/subscribe?INTCMP=amp_footer_support_subscribe&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_support_subscribe%22%7D","support":"https://support.theguardian.com?INTCMP=footer_support&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22footer_support%22%7D","supporter":"https://support.theguardian.com/subscribe?INTCMP=amp_footer_supporter_cta&acquisitionData=%7B%22source%22:%22GUARDIAN_WEB%22,%22componentType%22:%22ACQUISITIONS_FOOTER%22,%22componentId%22:%22amp_footer_supporter_cta%22%7D"}}},"showBottomSocialButtons":true,"pageFooter":{"footerLinks":[[{"text":"About us","url":"/about","dataLinkName":"uk : footer : about us","extraClasses":""},{"text":"Help","url":"https://manage.theguardian.com/help-centre","dataLinkName":"uk : footer : tech feedback","extraClasses":"js-tech-feedback-report"},{"text":"Complaints & corrections","url":"/info/complaints-and-corrections","dataLinkName":"complaints","extraClasses":""},{"text":"SecureDrop","url":"https://www.theguardian.com/securedrop","dataLinkName":"securedrop","extraClasses":""},{"text":"Work for us","url":"https://workforus.theguardian.com","dataLinkName":"uk : footer : work for us","extraClasses":""},{"text":"Privacy policy","url":"/info/privacy","dataLinkName":"privacy","extraClasses":""},{"text":"Cookie policy","url":"/info/cookies","dataLinkName":"cookie","extraClasses":""},{"text":"Terms & conditions","url":"/help/terms-of-service","dataLinkName":"terms","extraClasses":""},{"text":"Contact us","url":"/help/contact-us","dataLinkName":"uk : footer : contact us","extraClasses":""}],[{"text":"All topics","url":"/index/subjects/a","dataLinkName":"uk : footer : all topics","extraClasses":""},{"text":"All writers","url":"/index/contributors","dataLinkName":"uk : footer : all contributors","extraClasses":""},{"text":"Modern Slavery Act","url":"https://uploads.guim.co.uk/2024/09/04/Modern_Slavery_Statement_2024_.pdf","dataLinkName":"uk : footer : modern slavery act statement","extraClasses":""},{"text":"Tax strategy","url":"https://uploads.guim.co.uk/2024/08/27/TAX_STRATEGY_FOR_THE_YEAR_ENDED_31_MARCH_2025.pdf","dataLinkName":"uk : footer : tax strategy","extraClasses":""},{"text":"Digital newspaper archive","url":"https://theguardian.newspapers.com","dataLinkName":"digital newspaper archive","extraClasses":""},{"text":"Facebook","url":"https://www.facebook.com/theguardian","dataLinkName":"uk : footer : facebook","extraClasses":""},{"text":"YouTube","url":"https://www.youtube.com/user/TheGuardian","dataLinkName":"uk : footer : youtube","extraClasses":""},{"text":"Instagram","url":"https://www.instagram.com/guardian","dataLinkName":"uk : footer : instagram","extraClasses":""},{"text":"LinkedIn","url":"https://www.linkedin.com/company/theguardian","dataLinkName":"uk : footer : linkedin","extraClasses":""},{"text":"Newsletters","url":"/email-newsletters?INTCMP=DOTCOM_FOOTER_NEWSLETTER_UK","dataLinkName":"uk : footer : newsletters","extraClasses":""}],[{"text":"Advertise with us","url":"https://advertising.theguardian.com","dataLinkName":"uk : footer : advertise with us","extraClasses":""},{"text":"Guardian Labs","url":"/guardian-labs","dataLinkName":"uk : footer : guardian labs","extraClasses":""},{"text":"Search jobs","url":"https://jobs.theguardian.com","dataLinkName":"uk : footer : jobs","extraClasses":""},{"text":"Patrons","url":"https://patrons.theguardian.com?INTCMP=footer_patrons","dataLinkName":"uk : footer : patrons","extraClasses":""}]]},"publication":"theguardian.com","shouldHideReaderRevenue":false,"slotMachineFlags":"","contributionsServiceUrl":"https://contributions.guardianapis.com","isSpecialReport":false,"showTableOfContents":false,"lang":"en","isRightToLeftLang":false}